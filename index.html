<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-text="class.fullName"></title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #2c3e50;
            --accent-color: #e74c3c;
            --bg-color: #f4f7f6;
            --text-color: #333;
            --white: #ffffff;
            --success-color: #2ecc71;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            position: relative;
        }

        /* Tối ưu cho mobile - giảm animation để tránh lag */
        @media (max-width: 600px) {
            body {
                padding: 0;
                /* Tắt hoàn toàn animation trên mobile */
                animation: none !important;
                background-position: 0% 50%;
                /* Tối ưu rendering */
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            /* Tắt tất cả hiệu ứng phức tạp */
            body::before {
                display: none !important;
            }

            /* Tắt backdrop-filter - rất tốn tài nguyên */
            * {
                backdrop-filter: none !important;
                -webkit-backdrop-filter: none !important;
            }

            /* Giảm box-shadow phức tạp */
            * {
                box-shadow: none !important;
            }

            /* Chỉ giữ lại shadow đơn giản cho container */
            .container {
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
            }

            header {
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
            }

            .section-wrapper {
                box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1) !important;
            }
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3),
                        0 0 0 1px rgba(255, 255, 255, 0.5) inset;
            position: relative;
            z-index: 1;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Header Section */
        header {
            text-align: center;
            margin-bottom: 50px;
            padding: 30px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: shimmer 3s infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes shimmer {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        h1 {
            font-size: 42px;
            background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-transform: uppercase;
            margin-bottom: 10px;
            font-weight: 800;
            letter-spacing: 3px;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 2;
            line-height: 1.2;
        }

        .gvcn-info {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 20px;
            font-weight: 500;
            letter-spacing: 1px;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .gvcn-info i {
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
        }

        header .contact-section {
            position: relative;
            z-index: 2;
        }

        /* Hiệu ứng cho mobile */
        @media (max-width: 600px) {
            h1 {
                font-size: 28px;
                letter-spacing: 2px;
            }

            .gvcn-info {
                font-size: 16px;
                margin-bottom: 15px;
            }

            .gvcn-info i {
                font-size: 14px;
            }

            .career-section {
                flex-direction: column;
                gap: 10px;
                margin: 15px 0;
            }

            .career-section a {
                font-size: 14px;
                padding: 10px 20px;
                width: 100%;
                justify-content: center;
            }

            header {
                padding: 20px 10px;
                margin-bottom: 20px;
                margin-left: -10px;
                margin-right: -10px;
                width: calc(100% + 20px);
                border-radius: 0;
            }

            /* Tối ưu hiệu suất - disable một số transform phức tạp */
            .teacher-info:hover {
                transform: none;
            }

            table:hover {
                transform: none;
            }

            /* Tắt tất cả transition và animation không cần thiết */
            * {
                transition: none !important;
                animation: none !important;
            }

            /* Loại trừ vòng quay khỏi rule tắt animation */
            .wheel-container:not(.hidden) *,
            .wheel-container:not(.hidden) .wheel-pointer,
            .wheel-container:not(.hidden) #random-wheel,
            .wheel-container:not(.hidden) .wheel-result.highlight {
                animation: initial !important;
            }

            .wheel-container:not(.hidden) #random-wheel {
                transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1) !important;
            }

            .wheel-container:not(.hidden) #random-wheel.spinning {
                transition: transform 3s cubic-bezier(0.23, 1, 0.32, 1) !important;
            }

            /* Chỉ giữ lại transition cho countdown (cần thiết) */
            .countdown-value,
            .countdown-label {
                transition: opacity 0.2s ease !important;
            }

            /* Tắt tất cả pseudo-elements phức tạp */
            header::before,
            header::after,
            .section-wrapper::before,
            .section-wrapper::after,
            .countdown-section::before,
            .countdown-section::after {
                display: none !important;
            }

            /* Tối ưu rendering với GPU acceleration và contain */
            .section-wrapper,
            .container,
            header,
            .countdown-section {
                transform: translateZ(0);
                -webkit-transform: translateZ(0);
                will-change: auto;
                contain: layout style paint;
            }

            /* Tối ưu container */
            .container {
                background: rgba(255, 255, 255, 0.98);
                /* Không dùng backdrop-filter trên mobile */
            }

            /* Tắt các hiệu ứng hover */
            *:hover {
                transform: none !important;
            }

            /* Tối ưu font rendering */
            body,
            .container,
            header,
            h1,
            h2,
            p {
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                text-rendering: optimizeSpeed;
            }

            /* Tắt text-shadow phức tạp */
            * {
                text-shadow: none !important;
            }

            /* Giữ lại text-shadow đơn giản cho h2 */
            h2 {
                text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
            }

            /* Tối ưu wheel container */
            .wheel-container {
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
            }

            /* Tối ưu report links */
            .report-links a {
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
            }

            .report-links a::before {
                display: none !important;
            }

            .report-links a:hover {
                transform: none !important;
            }

            /* Tắt tất cả icon animations */
            i {
                animation: none !important;
            }

            /* Tối ưu table rendering */
            table {
                border-collapse: separate;
                border-spacing: 0;
            }

            /* Tối ưu scroll performance */
            * {
                -webkit-overflow-scrolling: touch;
                overscroll-behavior: contain;
            }

            /* Giảm repaint/reflow */
            .container {
                isolation: isolate;
            }

            /* Tối ưu images nếu có */
            img {
                image-rendering: -webkit-optimize-contrast;
                image-rendering: crisp-edges;
            }

            /* Disable pointer events cho các phần tử không cần thiết */
            body::before,
            header::before,
            header::after {
                pointer-events: none;
            }
        }

        .teacher-info {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(240, 242, 245, 0.9) 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 18px;
            border-left: 6px solid var(--primary-color);
            display: inline-block;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1),
                        0 0 0 1px rgba(255, 255, 255, 0.5) inset;
            transition: all 0.3s ease;
        }

        .teacher-info:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15),
                        0 0 0 1px rgba(255, 255, 255, 0.6) inset;
        }

        .teacher-info p {
            font-size: 18px;
            font-weight: 500;
            color: var(--secondary-color);
            margin: 5px 0;
        }

        .teacher-info i {
            color: var(--primary-color);
            margin-right: 10px;
        }

        /* Section Titles */
        h2 {
            font-size: 28px;
            margin: 0 0 25px 0;
            padding: 18px 25px;
            border-radius: 16px;
            text-transform: uppercase;
            font-weight: 800;
            letter-spacing: 2px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            text-align: center;
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        /* H2 có toggle icon */
        h2[onclick] {
            justify-content: space-between;
        }

        /* H2 có toggle (clickable) */
        h2[onclick] {
            cursor: pointer;
            user-select: none;
        }

        h2 i {
            margin-right: 12px;
            font-size: 24px;
            position: relative;
        }

        /* Icon chevron trong h2 có toggle */
        h2[onclick] i.fa-chevron-down {
            margin-left: auto;
            margin-right: 0;
            font-size: 18px;
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        h2[onclick]:hover i.fa-chevron-down {
            opacity: 1;
        }

        /* Icon glow effect */
        h2 i::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            animation: iconGlow 2s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes iconGlow {
            0%, 100% {
                width: 0;
                height: 0;
                opacity: 0;
            }
            50% {
                width: 40px;
                height: 40px;
                opacity: 1;
            }
        }

        /* Timetable Section */
        .timetable-section {
            overflow-x: auto;
            margin-bottom: 30px;
            position: relative;
        }

        .timetable-section h2 {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .edit-link {
            margin-left: auto;
            color: #667eea;
            font-size: 18px;
            text-decoration: none;
            opacity: 0.7;
            transition: all 0.3s ease;
            padding: 5px 10px;
            border-radius: 8px;
        }

        .edit-link:hover {
            opacity: 1;
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1),
                        0 0 0 1px rgba(0, 0, 0, 0.05) inset;
            transition: all 0.3s ease;
        }

        table:hover {
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15),
                        0 0 0 1px rgba(0, 0, 0, 0.08) inset;
            transform: translateY(-2px);
        }

        th,
        td {
            padding: 12px;
            text-align: center;
            border: 1px solid #e0e0e0;
            font-size: 14px;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--white);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        th::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.3), transparent);
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        /* Màu sắc cho các môn học */
        td.subject-toan {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }

        td.subject-van {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            font-weight: 600;
        }

        td.subject-anh {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            font-weight: 600;
        }

        td.subject-dia {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            font-weight: 600;
        }

        td.subject-su {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
            font-weight: 600;
        }

        td.subject-gdktpl {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
            color: white;
            font-weight: 600;
        }

        td.subject-tin {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
            font-weight: 600;
        }

        td.subject-cn {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #333;
            font-weight: 600;
        }

        td.subject-gdtc {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
            font-weight: 600;
        }

        td.subject-gdqp {
            background: linear-gradient(135deg, #ff8a80 0%, #ea6100 100%);
            color: white;
            font-weight: 600;
        }

        td.subject-gdhn {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            color: #333;
            font-weight: 600;
        }

        td.subject-hdtn {
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
            color: #333;
            font-weight: 600;
        }

        td.subject-shcn {
            background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
            color: #333;
            font-weight: 600;
        }

        /* Hover effect cho các môn học */
        td[class*="subject-"]:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
        }

        .session-title {
            font-weight: bold;
            color: var(--accent-color);
            margin-top: 15px;
            margin-bottom: 10px;
            display: block;
        }

        /* Tooltip Styles */
        td[data-tooltip] {
            position: relative;
            cursor: help;
        }

        td[data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 50%;
            bottom: 100%;
            transform: translateX(-50%);
            margin-bottom: 10px;
            padding: 12px 16px;
            background-color: var(--secondary-color);
            color: var(--white);
            border-radius: 8px;
            font-size: 13px;
            white-space: pre-line;
            text-align: left;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            min-width: 220px;
            max-width: 300px;
            pointer-events: none;
            animation: fadeIn 0.3s ease;
            line-height: 1.6;
        }

        td[data-tooltip]:hover::before {
            content: '';
            position: absolute;
            left: 50%;
            bottom: 100%;
            transform: translateX(-50%);
            margin-bottom: 2px;
            border: 6px solid transparent;
            border-top-color: var(--secondary-color);
            z-index: 1001;
            pointer-events: none;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        /* Đảm bảo tooltip hiển thị tốt trên mobile */
        @media (max-width: 600px) {
            td[data-tooltip]:hover::after {
                min-width: 180px;
                max-width: 250px;
                font-size: 12px;
                padding: 10px 12px;
            }
        }

        /* Section Wrapper - Khung bao đẹp cho từng khu vực */
        .section-wrapper {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius: 24px;
            padding: 0;
            margin-bottom: 30px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15),
                        0 0 0 1px rgba(255, 255, 255, 0.4) inset;
            border: 2px solid rgba(255, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
        }

        .section-wrapper > h2 {
            margin: 0;
            border-radius: 22px 22px 0 0;
            padding: 22px 25px;
            position: relative;
            overflow: hidden;
        }

        /* Animation cho tiêu đề */
        .section-wrapper > h2::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: titleShimmer 3s infinite;
        }

        @keyframes titleShimmer {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        /* Icon animation */
        .section-wrapper > h2 i {
            display: inline-block;
            animation: iconBounce 2s ease-in-out infinite;
        }

        @keyframes iconBounce {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            25% {
                transform: translateY(-3px) rotate(-5deg);
            }
            75% {
                transform: translateY(-3px) rotate(5deg);
            }
        }

        /* Pulse effect cho tiêu đề */
        .section-wrapper > h2 {
            animation: titlePulse 4s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% {
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            }
            50% {
                box-shadow: 0 6px 25px rgba(0, 0, 0, 0.25);
            }
        }

        .section-wrapper > *:not(h2) {
            padding: 25px 30px 30px 30px;
            position: relative;
            z-index: 1;
        }

        /* Đảm bảo có khoảng cách giữa tiêu đề và nội dung */
        .section-wrapper > h2 + * {
            margin-top: 0;
            padding-top: 25px;
        }

        /* Màu sắc khác nhau cho từng khu vực - Tiêu đề và nền */
        .section-wrapper:nth-of-type(1) {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.15) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(1) h2 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .section-wrapper:nth-of-type(2) {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.15) 0%, rgba(245, 87, 108, 0.15) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(2) h2 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .section-wrapper:nth-of-type(3) {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.15) 0%, rgba(0, 242, 254, 0.15) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(3) h2 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .section-wrapper:nth-of-type(4) {
            background: linear-gradient(135deg, rgba(250, 112, 154, 0.15) 0%, rgba(254, 225, 64, 0.15) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(4) h2 {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .section-wrapper:nth-of-type(5) {
            background: linear-gradient(135deg, rgba(48, 207, 208, 0.15) 0%, rgba(51, 8, 103, 0.15) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(5) h2 {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        }

        /* Admission section - màu hồng đẹp với text dễ đọc */
        .admission-section.section-wrapper {
            background: linear-gradient(135deg, rgba(255, 240, 245, 0.95) 0%, rgba(255, 228, 236, 0.95) 50%, rgba(255, 218, 225, 0.95) 100%),
                        rgba(255, 255, 255, 0.95) !important;
            border-color: rgba(255, 182, 193, 0.5) !important;
        }

        .admission-section.section-wrapper h2 {
            background: linear-gradient(135deg, #ff6b9d 0%, #c44569 50%, #f8b500 100%) !important;
            color: #fff !important;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        /* Text trong admission section - màu tối để dễ đọc */
        .admission-section.section-wrapper .admission-form label {
            color: #8b2252 !important;
            font-weight: 700 !important;
        }

        .admission-section.section-wrapper .combo-dropdown {
            background: rgba(255, 255, 255, 0.95) !important;
            color: #333 !important;
            border: 2px solid rgba(255, 182, 193, 0.6) !important;
            font-weight: 600 !important;
        }

        .admission-section.section-wrapper .combo-dropdown option {
            background: #fff !important;
            color: #333 !important;
        }

        .admission-section.section-wrapper .admission-form input {
            background: rgba(255, 255, 255, 0.95) !important;
            color: #333 !important;
            border: 2px solid rgba(255, 182, 193, 0.6) !important;
            font-weight: 600 !important;
        }

        .admission-section.section-wrapper .admission-form input::placeholder {
            color: #999 !important;
        }

        .admission-section.section-wrapper .admission-suggestion {
            color: #555 !important;
            background: rgba(255, 255, 255, 0.8) !important;
            border: 1px solid rgba(255, 182, 193, 0.5) !important;
        }

        .admission-section.section-wrapper .admission-note {
            color: #666 !important;
            font-weight: 500 !important;
        }

        .admission-section.section-wrapper .admission-card {
            background: rgba(255, 255, 255, 0.9) !important;
            border: 2px solid rgba(255, 182, 193, 0.6) !important;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.15) !important;
        }

        .admission-section.section-wrapper .admission-card h4 {
            color: #8b2252 !important;
            font-weight: 800 !important;
        }

        .admission-section.section-wrapper .admission-card p {
            color: #333 !important;
        }

        .admission-section.section-wrapper .admission-card p strong {
            color: #c44569 !important;
        }

        .admission-section.section-wrapper .admission-btn {
            background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%) !important;
            color: #fff !important;
            font-weight: 700 !important;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4) !important;
            border: 2px solid rgba(255, 255, 255, 0.3) !important;
        }

        .admission-section.section-wrapper .admission-btn {
            position: relative;
        }

        .admission-section.section-wrapper .admission-btn i {
            display: inline-block;
            animation: admissionIconSpin 3s ease-in-out infinite;
            margin-right: 8px;
        }

        @keyframes admissionIconSpin {
            0%, 100% {
                transform: rotate(0deg) scale(1);
            }
            50% {
                transform: rotate(180deg) scale(1.1);
            }
        }

        .admission-section.section-wrapper .admission-btn:hover {
            background: linear-gradient(135deg, #ff8bb3 0%, #d45a7a 100%) !important;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.5) !important;
            transform: translateY(-4px) scale(1.05) !important;
        }

        .admission-section.section-wrapper .admission-btn:hover i {
            animation: admissionIconFastSpin 0.8s ease-in-out infinite;
        }

        @keyframes admissionIconFastSpin {
            0% {
                transform: rotate(0deg) scale(1.2);
            }
            100% {
                transform: rotate(360deg) scale(1.2);
            }
        }

        /* Icon trong button "Quay ngẫu nhiên" */
        button[onclick="spinRandom()"] i,
        button.admission-btn:not(.admission-section .admission-btn) i {
            display: inline-block;
            animation: randomIconRotate 2s ease-in-out infinite;
            margin-right: 8px;
        }

        @keyframes randomIconRotate {
            0%, 100% {
                transform: rotate(0deg) scale(1);
            }
            50% {
                transform: rotate(180deg) scale(1.1);
            }
        }

        button[onclick="spinRandom()"]:hover i,
        button.admission-btn:not(.admission-section .admission-btn):hover i {
            animation: randomIconFastRotate 0.5s linear infinite;
        }

        @keyframes randomIconFastRotate {
            0% {
                transform: rotate(0deg) scale(1.2);
            }
            100% {
                transform: rotate(360deg) scale(1.2);
            }
        }

        /* Icon trong memory-btn */
        .memory-btn i {
            display: inline-block;
            animation: memoryBtnIconShake 2s ease-in-out infinite;
            margin-right: 8px;
        }

        @keyframes memoryBtnIconShake {
            0%, 100% {
                transform: translateX(0) rotate(0deg);
            }
            25% {
                transform: translateX(-2px) rotate(-5deg);
            }
            75% {
                transform: translateX(2px) rotate(5deg);
            }
        }

        .memory-btn:hover i {
            animation: memoryBtnIconBounce 0.6s ease-in-out infinite;
        }

        @keyframes memoryBtnIconBounce {
            0%, 100% {
                transform: translateY(0) rotate(0deg) scale(1.1);
            }
            50% {
                transform: translateY(-3px) rotate(10deg) scale(1.2);
            }
        }

        .section-wrapper:nth-of-type(6) {
            background: linear-gradient(135deg, rgba(168, 237, 234, 0.2) 0%, rgba(254, 214, 227, 0.2) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(6) h2 {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
        }

        .section-wrapper:nth-of-type(7) {
            background: linear-gradient(135deg, rgba(255, 154, 158, 0.2) 0%, rgba(254, 207, 239, 0.2) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(7) h2 {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #333;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
        }

        .section-wrapper:nth-of-type(8) {
            background: linear-gradient(135deg, rgba(255, 236, 210, 0.25) 0%, rgba(252, 182, 159, 0.25) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(8) h2 {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
        }

        .section-wrapper:nth-of-type(9) {
            background: linear-gradient(135deg, rgba(17, 153, 142, 0.15) 0%, rgba(56, 239, 125, 0.15) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(9) h2 {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .section-wrapper:nth-of-type(10) {
            background: linear-gradient(135deg, rgba(106, 17, 203, 0.15) 0%, rgba(37, 117, 252, 0.15) 100%),
                        rgba(255, 255, 255, 0.85);
        }

        .section-wrapper:nth-of-type(10) h2 {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        }

        /* Report Section Links */
        .report-links {
            position: relative;
        }

        /* Vòng Quay May mắn */
        .wheel-container {
            text-align: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(240, 242, 245, 0.9) 100%);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1), 0 0 0 1px rgba(255, 255, 255, 0.5) inset;
            border: 1px solid rgba(102, 126, 234, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
        }

        .wheel-container.hidden {
            display: none !important;
        }

        .wheel-container:not(.hidden) {
            display: block;
            animation: slideDown 0.4s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .wheel-wrapper {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 20px auto;
            width: fit-content;
        }

        #random-wheel {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2),
                        0 0 0 3px rgba(255, 255, 255, 0.5),
                        0 0 0 6px rgba(102, 126, 234, 0.3);
            transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            cursor: pointer;
            /* Tối ưu hiệu suất */
            will-change: transform;
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        #random-wheel.spinning {
            transition: transform 3s cubic-bezier(0.23, 1, 0.32, 1);
            will-change: transform;
        }

        .wheel-pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 30px solid #ff6b9d;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
            z-index: 10;
            animation: pointerPulse 1.5s ease-in-out infinite;
            /* Tối ưu hiệu suất */
            will-change: transform;
            transform: translateX(-50%) translateZ(0);
            -webkit-transform: translateX(-50%) translateZ(0);
        }

        @keyframes pointerPulse {
            0%, 100% {
                transform: translateX(-50%) translateY(0) scale(1) translateZ(0);
            }
            50% {
                transform: translateX(-50%) translateY(-3px) scale(1.05) translateZ(0);
            }
        }

        /* Tắt animation khi container hidden */
        .wheel-container.hidden .wheel-pointer {
            animation: none !important;
        }

        .wheel-container.hidden #random-wheel {
            transition: none !important;
        }

        /* Tối ưu wheel khi visible */
        .wheel-container:not(.hidden) #random-wheel {
            will-change: transform;
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
        }

        .wheel-result {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            font-weight: 800;
            color: #fff;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5),
                         0 0 20px rgba(255, 255, 255, 0.5);
            z-index: 5;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.5);
        }

        .wheel-result.highlight {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border-color: #ffd700;
            box-shadow: 0 0 40px rgba(102, 126, 234, 0.8),
                        0 0 60px rgba(118, 75, 162, 0.6),
                        0 0 80px rgba(240, 147, 251, 0.4),
                        inset 0 0 30px rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%) scale(1.3) translateZ(0);
            /* Chỉ giữ lại animation bounce khi xuất hiện, tắt animation glow chớp chớp */
            animation: resultBounce 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            opacity: 1;
            font-size: 28px;
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8),
                         0 0 20px rgba(255, 215, 0, 0.6),
                         0 2px 10px rgba(0, 0, 0, 0.7),
                         0 4px 15px rgba(0, 0, 0, 0.5);
            /* Tối ưu hiệu suất */
            will-change: transform, opacity;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        /* Tắt animation khi container hidden */
        .wheel-container.hidden .wheel-result.highlight {
            animation: none !important;
        }

        @keyframes resultBounce {
            0% {
                transform: translate(-50%, -50%) scale(0.5) translateZ(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.4) translateZ(0);
            }
            100% {
                transform: translate(-50%, -50%) scale(1.3) translateZ(0);
                opacity: 1;
            }
        }

        @keyframes resultGlow {
            0%, 100% {
                box-shadow: 0 0 40px rgba(102, 126, 234, 0.8),
                            0 0 60px rgba(118, 75, 162, 0.6),
                            0 0 80px rgba(240, 147, 251, 0.4),
                            inset 0 0 30px rgba(255, 255, 255, 0.3);
            }
            50% {
                box-shadow: 0 0 60px rgba(102, 126, 234, 1),
                            0 0 80px rgba(118, 75, 162, 0.8),
                            0 0 100px rgba(240, 147, 251, 0.6),
                            inset 0 0 40px rgba(255, 255, 255, 0.5);
            }
        }

        .wheel-spin-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white !important;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3) !important;
            border: 2px solid rgba(255, 255, 255, 0.3) !important;
            margin: 10px auto 0 auto;
            display: block;
        }

        .wheel-spin-btn:hover {
            background: linear-gradient(135deg, #7a8ef0 0%, #8650b8 100%) !important;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4) !important;
            transform: translateY(-2px) scale(1.02) !important;
        }

        .wheel-spin-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Icon toggle cho h2 */
        h2[onclick="toggleRandomWheel()"] {
            position: relative;
            justify-content: space-between;
        }

        h2[onclick="toggleRandomWheel()"] > i:first-child {
            margin-right: 12px;
        }

        #wheel-toggle-icon {
            transition: transform 0.3s ease, opacity 0.3s ease;
            margin-left: auto;
            opacity: 0.8;
            font-size: 18px;
        }

        .section-wrapper.active #wheel-toggle-icon {
            transform: rotate(180deg);
            opacity: 1;
        }

        h2[onclick="toggleRandomWheel()"]:hover #wheel-toggle-icon {
            opacity: 1;
        }

        .section-wrapper.active h2[onclick="toggleRandomWheel()"]:hover #wheel-toggle-icon {
            transform: rotate(180deg);
        }

        @media (max-width: 600px) {
            #random-wheel {
                width: 250px;
                height: 250px;
            }

            .wheel-result {
                width: 100px;
                height: 100px;
                font-size: 18px;
            }

            .wheel-pointer {
                border-left-width: 15px;
                border-right-width: 15px;
                border-top-width: 25px;
                top: -12px;
            }
        }

        .report-links ul {
            list-style: none;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .report-links a {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: var(--white);
            padding: 18px 24px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15),
                        0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            position: relative;
            overflow: hidden;
        }

        .report-links a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .report-links a i {
            margin-right: 15px;
            font-size: 22px;
            width: 25px;
            text-align: center;
            transition: transform 0.3s ease;
            display: inline-block;
            animation: iconPulse 2s ease-in-out infinite;
            position: relative;
        }

        @keyframes iconPulse {
            0%, 100% {
                transform: scale(1) rotate(0deg);
            }
            50% {
                transform: scale(1.1) rotate(5deg);
            }
        }

        .report-links a:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25),
                        0 0 0 1px rgba(255, 255, 255, 0.2) inset;
            filter: brightness(1.15);
        }

        .report-links a:hover::before {
            left: 100%;
        }

        .report-links a:hover i {
            transform: scale(1.3) rotate(15deg) !important;
            animation: iconBounce 0.6s ease-in-out infinite;
        }

        @keyframes iconBounce {
            0%, 100% {
                transform: scale(1.3) rotate(15deg) translateY(0);
            }
            50% {
                transform: scale(1.3) rotate(15deg) translateY(-3px);
            }
        }

        /* Custom Gradients */
        .link-1 {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        }

        .link-2 {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .link-3 {
            background: linear-gradient(135deg, #fc4a1a 0%, #f7b733 100%);
        }

        .link-4 {
            background: linear-gradient(135deg, #ff9966 0%, #ff5e62 100%);
        }

        .link-5 {
            background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);
        }

        .link-6 {
            background: linear-gradient(135deg, #834d9b 0%, #d04ed6 100%);
        }

        .link-7 {
            background: linear-gradient(135deg, #134e5e 0%, #71b280 100%);
        }

        .link-8 {
            background: linear-gradient(135deg, #cb2d3e 0%, #ef473a 100%);
        }

        .link-9 {
            background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
        }

        .link-10 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .link-11 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .link-12 {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .link-13 {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        }

        .link-14 {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        .link-15 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .link-16 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .link-17 {
            background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);
        }

        /* Career Section trong Header */
        .career-section {
            position: relative;
            z-index: 2;
            margin: 20px 0;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .career-section a {
            display: inline-flex;
            align-items: center;
            text-decoration: none;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .career-section a:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            filter: brightness(1.1);
        }

        .career-section a i {
            margin-right: 10px;
            font-size: 18px;
            display: inline-block;
            animation: careerIconSwing 2.5s ease-in-out infinite;
            position: relative;
        }

        @keyframes careerIconSwing {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            25% {
                transform: translateY(-2px) rotate(-5deg);
            }
            75% {
                transform: translateY(-2px) rotate(5deg);
            }
        }

        .career-section a:hover i {
            animation: careerIconBounce 0.6s ease-in-out infinite;
        }

        @keyframes careerIconBounce {
            0%, 100% {
                transform: translateY(0) rotate(0deg) scale(1.1);
            }
            50% {
                transform: translateY(-4px) rotate(8deg) scale(1.2);
            }
        }

        /* Birthday Section */
        .birthday-section {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%);
            border-radius: 24px;
            padding: 35px;
            margin: 30px 0;
            text-align: center;
            box-shadow: 0 15px 50px rgba(255, 107, 107, 0.4),
                        0 0 0 2px rgba(255, 255, 255, 0.3) inset;
            position: relative;
            overflow: hidden;
            animation: birthdayPulse 2s ease-in-out infinite;
            border: 2px solid rgba(255, 255, 255, 0.4);
        }

        @keyframes birthdayPulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.02);
            }
        }

        .birthday-section.hidden {
            display: none;
        }

        .birthday-content {
            position: relative;
            z-index: 2;
        }

        .birthday-icon {
            font-size: 60px;
            color: white;
            margin-bottom: 15px;
            animation: bounce 1s ease-in-out infinite;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .birthday-message {
            font-size: 24px;
            color: white;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin: 10px 0;
            line-height: 1.6;
        }

        .birthday-name {
            color: #fff;
            font-size: 28px;
            font-weight: 800;
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4);
            display: inline-block;
            animation: nameGlow 2s ease-in-out infinite;
        }

        @keyframes nameGlow {

            0%,
            100% {
                text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4), 0 0 20px rgba(255, 255, 255, 0.5);
            }

            50% {
                text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4), 0 0 30px rgba(255, 255, 255, 0.8);
            }
        }

        /* Confetti/Fireworks */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            top: -10px;
            animation: confettiFall linear forwards;
            z-index: 1000;
            pointer-events: none;
        }

        @keyframes confettiFall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Password Modal */
        .password-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .password-modal.active {
            display: flex;
        }

        .password-content {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 35px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.5) inset;
            max-width: 420px;
            width: 90%;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .password-content h3 {
            color: var(--secondary-color);
            margin-bottom: 20px;
            font-size: 20px;
        }

        .password-content input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 15px;
            box-sizing: border-box;
        }

        .password-content input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .password-content button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 32px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            margin-right: 10px;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3),
                        0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            position: relative;
            overflow: hidden;
        }

        .password-content button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .password-content button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.2) inset;
        }

        .password-content button:hover::before {
            width: 300px;
            height: 300px;
        }

        .password-content .btn-cancel {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            box-shadow: 0 6px 20px rgba(149, 165, 166, 0.3),
                        0 0 0 1px rgba(255, 255, 255, 0.1) inset;
        }

        .password-content .btn-cancel:hover {
            box-shadow: 0 10px 30px rgba(149, 165, 166, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.2) inset;
        }

        .password-error {
            color: var(--accent-color);
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        /* Contact Section */
        .contact-section {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1),
                        0 0 0 1px rgba(255, 255, 255, 0.3) inset;
            border: 1px solid rgba(255, 255, 255, 0.4);
            position: relative;
        }

        .contact-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #2ecc71 0%, #0068ff 100%);
            border-radius: 20px 20px 0 0;
        }

        .btn-contact {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 14px 32px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 700;
            color: white;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2),
                        0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            position: relative;
            overflow: hidden;
        }

        .btn-contact::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-contact:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3),
                        0 0 0 1px rgba(255, 255, 255, 0.2) inset;
        }

        .btn-contact:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-call {
            background-color: var(--success-color);
        }

        .btn-zalo {
            background-color: #0068ff;
        }

        .btn-contact i {
            margin-right: 10px;
            display: inline-block;
            animation: contactIconWave 2s ease-in-out infinite;
            position: relative;
        }

        @keyframes contactIconWave {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            25% {
                transform: translateY(-2px) rotate(-3deg);
            }
            75% {
                transform: translateY(-2px) rotate(3deg);
            }
        }

        .btn-contact:hover i {
            animation: contactIconBounce 0.5s ease-in-out infinite;
        }

        @keyframes contactIconBounce {
            0%, 100% {
                transform: translateY(0) rotate(0deg) scale(1.1);
            }
            50% {
                transform: translateY(-4px) rotate(5deg) scale(1.2);
            }
        }

        /* Memories simple link */
        .memories-section {
            margin: 30px 0;
            position: relative;
        }

        .memory-card {
            background: linear-gradient(135deg, #7f7fd5 0%, #86a8e7 50%, #91eae4 100%);
            border-radius: 20px;
            padding: 22px 25px;
            box-shadow: 0 15px 40px rgba(127, 127, 213, 0.3),
                        0 0 0 1px rgba(255, 255, 255, 0.2) inset;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            flex-wrap: wrap;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .memory-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: cardShimmer 4s infinite;
        }

        @keyframes cardShimmer {
            0%, 100% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(180deg);
            }
        }

        .memory-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 50px rgba(127, 127, 213, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.3) inset;
        }

        .memory-title {
            font-weight: 800;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0;
        }

        .memory-title i {
            font-size: 22px;
            display: inline-block;
            animation: memoryIconFloat 3s ease-in-out infinite;
            position: relative;
        }

        @keyframes memoryIconFloat {
            0%, 100% {
                transform: translateY(0) rotate(0deg) scale(1);
            }
            50% {
                transform: translateY(-5px) rotate(10deg) scale(1.1);
            }
        }

        .memory-card:hover .memory-title i {
            animation: memoryIconSpin 1s ease-in-out infinite;
        }

        @keyframes memoryIconSpin {
            0% {
                transform: rotate(0deg) scale(1.2);
            }
            100% {
                transform: rotate(360deg) scale(1.2);
            }
        }

        .memory-btn {
            padding: 12px 18px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            font-weight: 700;
            text-decoration: none;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
            transition: all 0.2s ease;
        }

        .memory-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.2);
        }

        /* Admission calculator */
        .admission-section {
            margin: 30px 0;
            padding: 25px;
            border-radius: 20px;
            background: linear-gradient(135deg, #1f1c2c 0%, #928dab 100%);
            color: #fff;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3),
                        0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .admission-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 0%, transparent 70%);
            animation: sectionShimmer 6s infinite;
        }

        @keyframes sectionShimmer {
            0%, 100% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(180deg);
            }
        }

        .admission-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.35),
                        0 0 0 1px rgba(255, 255, 255, 0.15) inset;
        }


        .admission-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 14px;
        }

        .combo-dropdown {
            width: 100%;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.35);
            background: rgba(0, 0, 0, 0.25);
            color: #fff;
            font-weight: 700;
        }

        .combo-dropdown option {
            background: #1f1c2c;
            color: #fff;
        }

        .admission-suggestion {
            margin-top: 10px;
            font-size: 13px;
            color: #fefefe;
            background: rgba(255, 255, 255, 0.08);
            padding: 10px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .admission-form label {
            display: block;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .admission-form input {
            width: 100%;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.35);
            background: rgba(255, 255, 255, 0.08);
            color: #fff;
            font-weight: 600;
        }

        .admission-form input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .admission-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }

        .admission-btn {
            border: none;
            border-radius: 12px;
            padding: 12px 20px;
            font-weight: 700;
            color: #1f1c2c;
            background: linear-gradient(135deg, #ffefba 0%, #ffffff 100%);
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25),
                        0 0 0 1px rgba(255, 255, 255, 0.3) inset;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .admission-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(31, 28, 44, 0.1);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .admission-btn:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3),
                        0 0 0 1px rgba(255, 255, 255, 0.4) inset;
        }

        .admission-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .admission-result {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .admission-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px;
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.05);
        }

        .admission-card h4 {
            margin: 0 0 6px 0;
            font-size: 15px;
            font-weight: 800;
        }

        .admission-card p {
            margin: 0;
            font-size: 14px;
            color: #e0e3ff;
        }

        .admission-note {
            margin-top: 10px;
            font-size: 13px;
            color: #e0e3ff;
        }

        /* Countdown HK1 */
        .countdown-section {
            margin: 15px 0;
            padding: 12px 18px;
            border-radius: 14px;
            color: #fff;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25),
                        0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        /* Màu khác nhau cho từng bộ đếm */
        .countdown-section:nth-of-type(1) {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .countdown-section:nth-of-type(2) {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .countdown-section:nth-of-type(3) {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .countdown-section:nth-of-type(1):hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.15) inset;
        }

        .countdown-section:nth-of-type(2):hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.15) inset;
        }

        .countdown-section:nth-of-type(3):hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(79, 172, 254, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.15) inset;
        }

        .countdown-section::before,
        .countdown-section::after {
            content: '';
            position: absolute;
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.35), rgba(255, 255, 255, 0));
            filter: blur(6px);
            animation: glowMove 10s linear infinite;
        }

        .countdown-section::before {
            top: -80px;
            left: -60px;
        }

        .countdown-section::after {
            bottom: -100px;
            right: -80px;
            animation-direction: reverse;
        }

        @keyframes glowMove {
            0% {
                transform: translate(0, 0) scale(1);
            }

            50% {
                transform: translate(30px, 20px) scale(1.1);
            }

            100% {
                transform: translate(0, 0) scale(1);
            }
        }

        .countdown-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .countdown-title i {
            font-size: 18px;
            display: inline-block;
            animation: countdownIconFlip 2s ease-in-out infinite;
            position: relative;
        }

        @keyframes countdownIconFlip {
            0%, 100% {
                transform: rotateY(0deg) scale(1);
            }
            50% {
                transform: rotateY(180deg) scale(1.1);
            }
        }

        .countdown {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            position: relative;
            z-index: 1;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            width: 100%;
        }

        .countdown-card {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            padding: 4px 8px;
            text-align: center;
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.15), 0 2px 6px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(6px);
            display: inline-flex;
            align-items: center;
            gap: 3px;
            min-height: 28px;
        }

        .countdown-value {
            font-size: 14px;
            font-weight: 800;
            letter-spacing: 0.3px;
            color: #ffeb3b;
            text-shadow: 0 0 6px rgba(255, 235, 59, 0.9);
            line-height: 1.2;
        }

        .countdown-label {
            font-size: 10px;
            letter-spacing: 0.2px;
            color: rgba(255, 255, 255, 0.95);
            line-height: 1.2;
        }

        .countdown-completed {
            font-size: 13px;
            font-weight: 700;
            color: #ffeb3b;
            text-shadow: 0 0 8px rgba(255, 235, 59, 0.9);
            padding: 5px 12px;
            background: rgba(255, 107, 107, 0.25);
            border: 1px solid rgba(255, 107, 107, 0.5);
            border-radius: 6px;
            text-align: center;
            margin: 0 auto;
            display: inline-block;
        }

        .countdown-note {
            margin-top: 8px;
            text-align: center;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.9);
            position: relative;
            z-index: 1;
            opacity: 0.95;
        }

        @media (max-width: 600px) {
            .countdown-section {
                padding: 8px 12px;
                margin: 10px 0;
            }

            .countdown-title {
                font-size: 12px;
                margin-bottom: 6px;
                gap: 4px;
                flex-wrap: wrap;
                line-height: 1.2;
            }

            .countdown-title i {
                font-size: 13px;
            }

            .countdown {
                display: flex;
                flex-wrap: wrap;
                gap: 4px;
                width: 100%;
                justify-content: center;
            }

            .countdown-card {
                padding: 3px 6px;
                gap: 2px;
                flex-shrink: 0;
                min-height: 24px;
            }

            .countdown-value {
                font-size: 12px;
            }

            .countdown-label {
                font-size: 8px;
            }

            .countdown-completed {
                font-size: 10px;
                padding: 3px 8px;
                display: inline-block;
            }

            .countdown-note {
                font-size: 8px;
                margin-top: 5px;
                line-height: 1.2;
            }
        }

        /* Bảng xếp hạng tổ (render từ CSV) */
        .ranking-embed {
            width: 100%;
            max-width: 1100px;
            margin: 0 auto;
            border-radius: 18px;
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.15),
                        0 0 0 1px rgba(0, 0, 0, 0.05) inset;
            background: #fff;
            overflow: hidden;
            padding: 15px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
        }

        .ranking-embed:hover {
            box-shadow: 0 15px 45px rgba(0, 0, 0, 0.2),
                        0 0 0 1px rgba(102, 126, 234, 0.3) inset;
            transform: translateY(-2px);
        }

        .ranking-table-wrap {
            overflow-x: auto;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            touch-action: pan-x;
            overscroll-behavior: contain;
            max-height: 600px;
            width: 100%;
        }

        .ranking-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
            table-layout: auto;
        }

        .ranking-table th,
        .ranking-table td {
            border: 1px solid #e0e0e0;
            padding: 8px 10px;
            text-align: center;
            font-size: 14px;
            vertical-align: middle;
        }

        .ranking-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            position: sticky;
            top: 0;
            z-index: 1;
            font-weight: 700;
        }

        .ranking-status {
            text-align: center;
            color: #555;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .timetable-status {
            text-align: center;
            color: #555;
            font-size: 14px;
            margin-bottom: 8px;
            padding: 10px;
        }

        /* Tô màu cột giống vibe thời khóa biểu */
        .ranking-table td.col-week {
            background: linear-gradient(135deg, #fff8e1, #ffecb3);
            font-weight: 700;
        }

        .ranking-table td.col-t1 {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
        }

        .ranking-table td.col-t2 {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
        }

        .ranking-table td.col-t3 {
            background: linear-gradient(135deg, #fce4ec, #f8bbd0);
        }

        .ranking-table td.col-t4 {
            background: linear-gradient(135deg, #ede7f6, #d1c4e9);
        }

        .ranking-table td.col-rank {
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            font-weight: 700;
            color: #5c3c87;
        }

        /* Đảm bảo cột có độ rộng hợp lý */
        .ranking-table th:nth-child(1),
        .ranking-table td:nth-child(1) {
            width: 15%;
            min-width: 80px;
        }

        .ranking-table th:nth-child(2),
        .ranking-table td:nth-child(2),
        .ranking-table th:nth-child(3),
        .ranking-table td:nth-child(3),
        .ranking-table th:nth-child(4),
        .ranking-table td:nth-child(4),
        .ranking-table th:nth-child(5),
        .ranking-table td:nth-child(5) {
            width: 20%;
            min-width: 100px;
        }

        .ranking-table th:nth-child(6),
        .ranking-table td:nth-child(6) {
            width: 15%;
            min-width: 80px;
        }

        .winner-cell {
            position: relative;
            z-index: 2;
            background: linear-gradient(135deg, #ffb6f6 0%, #ff9df0 30%, #ffd36f 70%, #fff1b8 100%) !important;
            color: #2b1d00 !important;
            font-weight: 800;
            border: 2px solid #ffd700;
            box-shadow:
                0 0 0 2px rgba(255, 255, 255, 0.7),
                0 0 26px rgba(255, 180, 255, 0.9),
                0 10px 24px rgba(0, 0, 0, 0.32);
            animation: winnerPulse 1.4s ease-in-out infinite;
            border-radius: 12px;
            overflow: hidden;
        }

        .winner-cell::before {
            content: '';
            position: absolute;
            inset: -6px;
            border-radius: 14px;
            background: linear-gradient(135deg, #ff80ff 0%, #ffd36f 40%, #8be2ff 80%, #ff80ff 100%);
            filter: blur(0px);
            z-index: -1;
            animation: winnerFrame 2s linear infinite;
        }

        .winner-cell::after {
            content: '';
            position: absolute;
            inset: 2px;
            border-radius: 10px;
            background: radial-gradient(circle at 10% 10%, rgba(255, 255, 255, 0.45), rgba(255, 255, 255, 0) 35%),
                radial-gradient(circle at 90% 15%, rgba(255, 255, 255, 0.35), rgba(255, 255, 255, 0) 40%),
                radial-gradient(circle at 50% 95%, rgba(255, 214, 255, 0.4), rgba(255, 214, 255, 0) 45%);
            pointer-events: none;
            z-index: -1;
        }

        @keyframes winnerPulse {

            0%,
            100% {
                box-shadow:
                    0 0 0 0 rgba(255, 215, 0, 0.7),
                    0 0 22px rgba(255, 200, 64, 0.95),
                    0 8px 22px rgba(0, 0, 0, 0.32);
            }

            50% {
                box-shadow:
                    0 0 0 18px rgba(255, 215, 0, 0),
                    0 0 30px rgba(255, 200, 64, 0.98),
                    0 10px 26px rgba(0, 0, 0, 0.34);
            }
        }

        @keyframes winnerGlow {

            0%,
            100% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.08);
                opacity: 0.75;
            }
        }

        @keyframes winnerFrame {
            0% {
                filter: hue-rotate(0deg);
            }

            100% {
                filter: hue-rotate(360deg);
            }
        }

        @media (max-width: 600px) {
            .ranking-table {
                min-width: 100%;
                width: 100%;
                font-size: 10px;
                table-layout: fixed;
            }

            .ranking-table th,
            .ranking-table td {
                padding: 6px 4px;
                font-size: 10px;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .ranking-table-wrap {
                max-height: 500px;
                overflow-x: visible;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
                width: 100%;
            }

            .ranking-embed {
                padding: 8px;
            }

            /* Điều chỉnh độ rộng cột trên mobile */
            .ranking-table th:nth-child(1),
            .ranking-table td:nth-child(1) {
                width: 12%;
                min-width: 50px;
            }

            .ranking-table th:nth-child(2),
            .ranking-table td:nth-child(2),
            .ranking-table th:nth-child(3),
            .ranking-table td:nth-child(3),
            .ranking-table th:nth-child(4),
            .ranking-table td:nth-child(4),
            .ranking-table th:nth-child(5),
            .ranking-table td:nth-child(5) {
                width: 18%;
                min-width: 60px;
            }

            .ranking-table th:nth-child(6),
            .ranking-table td:nth-child(6) {
                width: 16%;
                min-width: 50px;
            }

            /* Giảm hiệu ứng trên mobile để tối ưu hiệu suất */
            .winner-cell {
                animation: winnerPulseMobile 2s ease-in-out infinite;
                font-size: 9px;
                padding: 4px 2px;
            }

            .winner-cell::before {
                animation: none;
            }
        }

        @keyframes winnerPulseMobile {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7),
                            0 0 15px rgba(255, 200, 64, 0.8),
                            0 4px 12px rgba(0, 0, 0, 0.2);
            }
            50% {
                box-shadow: 0 0 0 8px rgba(255, 215, 0, 0),
                            0 0 20px rgba(255, 200, 64, 0.9),
                            0 6px 16px rgba(0, 0, 0, 0.25);
            }
        }

        /* Mobile Responsive */
        @media (max-width: 600px) {
            .container {
                padding: 10px;
                border-radius: 0;
                margin: 0;
                max-width: 100%;
                min-height: 100vh;
            }

            .section-wrapper {
                padding: 15px 10px;
                border-radius: 0;
                margin-bottom: 15px;
                margin-left: -10px;
                margin-right: -10px;
                width: calc(100% + 20px);
            }

            h1 {
                font-size: 22px;
            }

            .gvcn-info {
                font-size: 14px;
            }

            .teacher-info p {
                font-size: 16px;
            }

            /* Thời khóa biểu cho mobile */
            .timetable-section {
                margin-bottom: 15px;
                margin-left: -10px;
                margin-right: -10px;
                width: calc(100% + 20px);
            }

            table {
                font-size: 11px;
                min-width: 100%;
                border-radius: 0;
                margin-bottom: 15px;
            }

            th,
            td {
                padding: 6px 3px;
                font-size: 10px;
                word-break: break-word;
            }

            th {
                font-size: 9px;
                padding: 6px 2px;
            }

            .session-title {
                font-size: 13px;
                margin-top: 10px;
                margin-bottom: 8px;
            }

            h2 {
                font-size: 18px;
                margin: 0 0 15px 0;
                padding: 12px 10px;
                letter-spacing: 0.5px;
            }

            .section-wrapper > *:not(h2) {
                padding: 15px 10px;
            }

            .section-wrapper > h2 + * {
                padding-top: 15px;
            }

            h2 i {
                font-size: 20px;
                margin-right: 10px;
            }

            h2 i {
                font-size: 20px;
                margin-right: 10px;
            }

            .countdown-section {
                margin: 10px 0;
                padding: 10px 8px;
                border-radius: 0;
                /* Tắt các pseudo-elements */
            }

            .countdown-section:hover {
                transform: none !important;
            }

            .countdown-section::before,
            .countdown-section::after {
                display: none !important;
            }

            /* Tối ưu buttons */
            .admission-btn,
            .btn-contact,
            button {
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
                transition: none !important;
            }

            .admission-btn::before,
            .admission-btn::after {
                display: none !important;
            }

            .admission-btn:hover {
                transform: none !important;
            }

            /* Tối ưu teacher-info */
            .teacher-info {
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
            }

            .teacher-info:hover {
                transform: none !important;
            }

            .countdown-title {
                font-size: 14px;
                margin-bottom: 8px;
            }

            .countdown {
                gap: 5px;
            }

            .countdown-card {
                padding: 8px 5px;
                min-width: 50px;
            }

            .countdown-value {
                font-size: 18px;
            }

            .countdown-label {
                font-size: 10px;
            }

            .countdown-note {
                font-size: 11px;
                margin-top: 8px;
            }

            .contact-section {
                flex-direction: column;
                padding: 10px;
                margin: 0 -10px;
                width: calc(100% + 20px);
            }

            .report-links ul {
                grid-template-columns: 1fr;
            }

            /* Tooltip trên mobile */
            td[data-tooltip]:hover::after {
                min-width: 150px;
                max-width: 200px;
                font-size: 11px;
                padding: 8px 10px;
            }
        }

        /* Màn hình rất nhỏ (điện thoại nhỏ) */
        @media (max-width: 400px) {
            table {
                font-size: 10px;
            }

            th,
            td {
                padding: 5px 2px;
                font-size: 9px;
            }

            th {
                font-size: 8px;
                padding: 5px 1px;
            }

            .session-title {
                font-size: 12px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1 data-text="class.fullName">Lớp 12C1 - 2024-2025</h1>
            <div class="gvcn-info">
                <i class="fas fa-chalkboard-teacher"></i>
                <span data-text="gvcn.display">GVCN: Võ Thanh Phong</span>
            </div>
            <div class="career-section">
                <a href="#" data-link="career.chatgpt"
                    class="link-15" target="_blank"><i class="fas fa-robot"></i> Bot Tư vấn hướng nghiệp</a>
                <a href="#" data-link="career.registerForm" class="link-16" target="_blank"><i
                        class="fas fa-user-graduate"></i> Đăng ký tư vấn học đường</a>
            </div>
            <section class="contact-section">
                <a href="#" data-link="gvcn.phone" class="btn-contact btn-call"><i class="fas fa-phone-volume"></i> Gọi Điện</a>
                <a href="#" data-link="gvcn.zalo" class="btn-contact btn-zalo" target="_blank"><i
                        class="fas fa-comment-dots"></i> Liên hệ Zalo</a>
            </section>
        </header>

        <!-- Birthday Section -->
        <section class="birthday-section hidden" id="birthdaySection">
            <div class="birthday-content">
                <div class="birthday-icon">
                    <i class="fas fa-birthday-cake"></i>
                </div>
                <div class="birthday-message" id="birthdayMessage">
                    Chúc mừng bạn <span class="birthday-name" id="birthdayName"></span>!<br>
                    Sinh nhật vui vẻ và ngày càng học giỏi! 🎉
                </div>
            </div>
        </section>

        <section class="report-links section-wrapper">
            <h2 onclick="toggleRandomWheel()"><i class="fas fa-gamepad"></i> Vòng Quay May mắn <i class="fas fa-chevron-down" id="wheel-toggle-icon"></i></h2>
            <div id="random-wheel-container" class="wheel-container hidden">
                <div class="wheel-wrapper">
                    <canvas id="random-wheel" width="300" height="300"></canvas>
                    <div class="wheel-pointer"></div>
                    <div id="random-result" class="wheel-result"></div>
                </div>
                <button onclick="spinRandom()" class="admission-btn wheel-spin-btn">
                    <i class="fas fa-sync-alt"></i> Quay ngẫu nhiên
                </button>
            </div>
        </section>

        <script>
            // Vòng quay may mắn
            let wheelRotation = 0;
            let isSpinning = false;
            let wheelCanvas, wheelCtx, studentsList = [];

            function toggleRandomWheel() {
                const container = document.getElementById('random-wheel-container');
                const icon = document.getElementById('wheel-toggle-icon');
                const section = container.closest('.section-wrapper');
                const pointer = container.querySelector('.wheel-pointer');
                const wheel = document.getElementById('random-wheel');
                
                if (container.classList.contains('hidden')) {
                    // Mở container - bật animation
                    container.classList.remove('hidden');
                    container.classList.add('active');
                    section.classList.add('active');
                    
                    // Bật lại animation cho pointer
                    if (pointer) {
                        pointer.style.animationPlayState = 'running';
                    }
                    
                    // Tối ưu wheel khi visible
                    if (wheel) {
                        wheel.style.willChange = 'transform';
                        wheel.style.transform = 'translateZ(0)';
                    }
                    
                    if (!wheelCanvas) {
                        initWheel();
                    }
                } else {
                    // Đóng container - tắt animation
                    container.classList.remove('active');
                    
                    // Tắt animation khi đóng
                    if (pointer) {
                        pointer.style.animationPlayState = 'paused';
                    }
                    
                    // Giảm will-change khi không visible
                    if (wheel) {
                        wheel.style.willChange = 'auto';
                    }
                    
                    setTimeout(() => {
                        container.classList.add('hidden');
                        section.classList.remove('active');
                    }, 400);
                }
            }

            function initWheel() {
                wheelCanvas = document.getElementById('random-wheel');
                if (!wheelCanvas) return;
                wheelCtx = wheelCanvas.getContext('2d');
                
                studentsList = (window.students || []).map(s => s.name).filter(Boolean);
                
                if (!studentsList.length) {
                    drawWheel([]);
                    return;
                }

                // Tạo nhiều phần bằng nhau cho mỗi học sinh
                const numSegments = Math.max(studentsList.length, 12);
                drawWheel(studentsList, numSegments);
            }

            function drawWheel(names, numSegments = 12) {
                if (!wheelCtx) return;
                
                const centerX = wheelCanvas.width / 2;
                const centerY = wheelCanvas.height / 2;
                const radius = Math.min(centerX, centerY) - 10;
                const anglePerSegment = (2 * Math.PI) / numSegments;

                // Màu sắc gradient đa dạng
                const colors = [
                    '#ff6b9d', '#4ecdc4', '#95e1d3', '#f38181',
                    '#aa96da', '#fcbad3', '#ffeaa7', '#dfe6e9',
                    '#ff7675', '#74b9ff', '#fd79a8', '#fdcb6e',
                    '#e17055', '#00b894', '#6c5ce7', '#a29bfe',
                    '#55efc4', '#81ecec', '#fab1a0', '#ffeaa7',
                    '#fd79a8', '#fdcb6e', '#e17055', '#00b894'
                ];

                // Vẽ từng phần
                for (let i = 0; i < numSegments; i++) {
                    const startAngle = i * anglePerSegment - Math.PI / 2;
                    const endAngle = (i + 1) * anglePerSegment - Math.PI / 2;

                    wheelCtx.beginPath();
                    wheelCtx.moveTo(centerX, centerY);
                    wheelCtx.arc(centerX, centerY, radius, startAngle, endAngle);
                    wheelCtx.closePath();

                    // Màu gradient cho mỗi phần
                    const gradient = wheelCtx.createRadialGradient(
                        centerX, centerY, 0,
                        centerX, centerY, radius
                    );
                    const color1 = colors[i % colors.length];
                    const color2 = colors[(i + 1) % colors.length];
                    gradient.addColorStop(0, color1);
                    gradient.addColorStop(1, color2);
                    
                    wheelCtx.fillStyle = gradient;
                    wheelCtx.fill();
                    
                    // Viền
                    wheelCtx.strokeStyle = 'rgba(255, 255, 255, 0.4)';
                    wheelCtx.lineWidth = 2;
                    wheelCtx.stroke();

                    // Vẽ tên học sinh (nếu có)
                    if (names.length > 0) {
                        const midAngle = (startAngle + endAngle) / 2;
                        const textRadius = radius * 0.65;
                        const textX = centerX + Math.cos(midAngle) * textRadius;
                        const textY = centerY + Math.sin(midAngle) * textRadius;

                        wheelCtx.save();
                        wheelCtx.translate(textX, textY);
                        // Xoay text theo hướng bán kính (từ tâm ra ngoài)
                        wheelCtx.rotate(midAngle);
                        wheelCtx.fillStyle = '#fff';
                        wheelCtx.font = 'bold 8px Roboto';
                        wheelCtx.textAlign = 'center';
                        wheelCtx.textBaseline = 'middle';
                        wheelCtx.shadowColor = 'rgba(0, 0, 0, 0.5)';
                        wheelCtx.shadowBlur = 3;
                        wheelCtx.shadowOffsetX = 1;
                        wheelCtx.shadowOffsetY = 1;
                        const name = names[i % names.length];
                        const maxLength = 10;
                        const displayName = name.length > maxLength ? name.substring(0, maxLength) + '..' : name;
                        wheelCtx.fillText(displayName, 0, 0);
                        wheelCtx.restore();
                    }
                }

                // Vòng tròn trung tâm
                wheelCtx.beginPath();
                wheelCtx.arc(centerX, centerY, 50, 0, 2 * Math.PI);
                const centerGradient = wheelCtx.createRadialGradient(
                    centerX, centerY, 0,
                    centerX, centerY, 50
                );
                centerGradient.addColorStop(0, 'rgba(255, 255, 255, 0.95)');
                centerGradient.addColorStop(1, 'rgba(255, 255, 255, 0.85)');
                wheelCtx.fillStyle = centerGradient;
                wheelCtx.fill();
                wheelCtx.strokeStyle = 'rgba(102, 126, 234, 0.6)';
                wheelCtx.lineWidth = 4;
                wheelCtx.stroke();
            }

            function spinRandom() {
                const resultEl = document.getElementById('random-result');
                const spinBtn = document.querySelector('.wheel-spin-btn');
                
                if (isSpinning) return;
                if (!studentsList.length) {
                    resultEl.textContent = 'Chưa có danh sách';
                    return;
                }

                isSpinning = true;
                spinBtn.disabled = true;
                resultEl.classList.remove('highlight');
                resultEl.textContent = '...';

                // Tính toán góc quay (ít nhất 5 vòng + góc ngẫu nhiên để chỉ vào phần đúng)
                const randomIndex = Math.floor(Math.random() * studentsList.length);
                const numSegments = Math.max(studentsList.length, 12);
                const anglePerSegment = 360 / numSegments;
                // Tính góc để pointer (ở trên) chỉ vào giữa phần được chọn
                // Pointer ở góc -90 độ (phía trên), cần điều chỉnh
                const targetAngle = randomIndex * anglePerSegment + (anglePerSegment / 2);
                const spins = 5 * 360; // 5 vòng
                // Điều chỉnh để pointer chỉ vào phần được chọn (cộng 90 vì pointer ở trên)
                const finalRotation = wheelRotation + spins + (360 - targetAngle + 90);

                wheelCanvas.classList.add('spinning');
                wheelCanvas.style.transform = `rotate(${finalRotation}deg)`;
                wheelRotation = finalRotation % 360;

                // Animation hiệu ứng
                setTimeout(() => {
                    resultEl.textContent = studentsList[randomIndex];
                    resultEl.classList.add('highlight');
                    
                    setTimeout(() => {
                        isSpinning = false;
                        spinBtn.disabled = false;
                        wheelCanvas.classList.remove('spinning');
                        // Kết quả sẽ giữ nguyên cho đến khi quay lần tiếp theo
                    }, 1000);
                }, 3000);
            }

            // Vẽ vòng quay khi container được mở
            document.addEventListener('DOMContentLoaded', function() {
                // Chờ một chút để đảm bảo students đã load
                setTimeout(() => {
                    const container = document.getElementById('random-wheel-container');
                    if (container && !container.classList.contains('hidden')) {
                        initWheel();
                    }
                }, 500);
            });
        </script>
        <section class="timetable-section section-wrapper">
            <h2>
                <i class="fas fa-calendar-alt"></i> Thời Khóa Biểu
                <a href="#" id="timetableEditLink" class="edit-link" target="_blank" title="Cập nhật thời khóa biểu">
                    <i class="fas fa-edit"></i>
                </a>
            </h2>
            <div>
                <section class="countdown-section">
                    <div class="countdown-title"><i class="fas fa-hourglass-half"></i> Đếm ngược thi HK1</div>
                    <div class="countdown" id="countdown-hk1">
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-hk1-days">--</div>
                            <div class="countdown-label">Ngày</div>
                        </div>
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-hk1-hours">--</div>
                            <div class="countdown-label">Giờ</div>
                        </div>
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-hk1-mins">--</div>
                            <div class="countdown-label">Phút</div>
                        </div>
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-hk1-secs">--</div>
                            <div class="countdown-label">Giây</div>
                        </div>
                    </div>
                    <p class="countdown-note">Thi học kỳ 1: 29/12/2025</p>
                </section>

                <section class="countdown-section">
                    <div class="countdown-title"><i class="fas fa-hourglass-half"></i> Đếm ngược thi HK2</div>
                    <div class="countdown" id="countdown-hk2">
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-hk2-days">--</div>
                            <div class="countdown-label">Ngày</div>
                        </div>
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-hk2-hours">--</div>
                            <div class="countdown-label">Giờ</div>
                        </div>
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-hk2-mins">--</div>
                            <div class="countdown-label">Phút</div>
                        </div>
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-hk2-secs">--</div>
                            <div class="countdown-label">Giây</div>
                        </div>
                    </div>
                    <p class="countdown-note">Thi học kỳ 2: 04/05/2026 (dự kiến)</p>
                </section>

                <section class="countdown-section">
                    <div class="countdown-title"><i class="fas fa-hourglass-half"></i> Đếm ngược Thi tốt nghiệp THPT</div>
                    <div class="countdown" id="countdown-tn">
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-tn-days">--</div>
                            <div class="countdown-label">Ngày</div>
                        </div>
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-tn-hours">--</div>
                            <div class="countdown-label">Giờ</div>
                        </div>
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-tn-mins">--</div>
                            <div class="countdown-label">Phút</div>
                        </div>
                        <div class="countdown-card">
                            <div class="countdown-value" id="cd-tn-secs">--</div>
                            <div class="countdown-label">Giây</div>
                        </div>
                    </div>
                    <p class="countdown-note">Thi tốt nghiệp THPT: 12/06/2026 (dự kiến)</p>
                </section>

                <div id="timetableStatus" class="timetable-status" style="display: none;">Đang tải thời khóa biểu...</div>
                <div id="timetableContainer">
                    <!-- Thời khóa biểu sẽ được render động từ Google Sheets -->
                </div>
            </div>
        </section>

        <section class="report-links section-wrapper">
            <h2><i class="fas fa-trophy"></i> Bảng xếp hạng Tổ</h2>
            <div class="ranking-embed">
                <div id="rankingStatus" class="ranking-status">Đang tải bảng...</div>
                <div class="ranking-table-wrap">
                    <table class="ranking-table" id="rankingTable"></table>
                </div>
            </div>
        </section>

        <section class="report-links section-wrapper">
            <h2><i class="fas fa-laptop-code"></i> Học online và Roboki AI cho học sinh</h2>
            <ul>
                <li><a href="#" data-link="learning.khanAcademy" class="link-12" target="_blank"><i
                            class="fas fa-graduation-cap"></i> KAV</a></li>
                <li><a href="#" data-link="learning.roboki" class="link-13" target="_blank"><i
                            class="fas fa-robot"></i> Gia sư ROBOKI AI</a></li>
                <li><a href="#" data-link="learning.smsEdu" class="link-14" target="_blank"><i
                            class="fas fa-chart-bar"></i> Kết quả học tập Smas</a></li>
                <li><a href="#" data-link="learning.toanmath" class="link-17" target="_blank"><i class="fas fa-book"></i> Kho tài
                        liệu & Đề thi Toán</a></li>
            </ul>
        </section>

        <section class="admission-section section-wrapper">
            <h2><i class="fas fa-calculator"></i> Tính điểm xét tuyển Đại học</h2>
            <div>
                <div class="admission-form">
                <div>
                    <label for="combo-ab">Chọn khối A/B</label>
                    <select id="combo-ab" class="combo-dropdown">
                        <option value="">-- Chọn tổ hợp A/B --</option>
                        <option value="A00">A00 (Toán, Lý, Hóa)</option>
                        <option value="A01">A01 (Toán, Lý, Anh)</option>
                        <option value="A02">A02 (Toán, Lý, Sinh)</option>
                        <option value="A03">A03 (Toán, Lý, Sử)</option>
                        <option value="A04">A04 (Toán, Lý, Địa)</option>
                        <option value="A05">A05 (Toán, Hóa, Sử)</option>
                        <option value="A06">A06 (Toán, Hóa, Địa)</option>
                        <option value="A07">A07 (Toán, Sử, Địa)</option>
                        <option value="A08">A08 (Toán, Sử, GDCD)</option>
                        <option value="A09">A09 (Toán, Địa, GDCD)</option>
                        <option value="A10">A10 (Toán, Lý, GDCD)</option>
                        <option value="A11">A11 (Toán, Hóa, GDCD)</option>
                        <option value="A12">A12 (Toán, KHTN, KHXH)</option>
                        <option value="A14">A14 (Toán, KHTN, Địa)</option>
                        <option value="A15">A15 (Toán, KHTN, GDCD)</option>
                        <option value="A16">A16 (Toán, KHTN, Văn)</option>
                        <option value="A18">A18 (Toán, Hóa, KHXH)</option>
                        <option value="B00">B00 (Toán, Hóa, Sinh)</option>
                        <option value="B01">B01 (Toán, Sinh, Sử)</option>
                        <option value="B02">B02 (Toán, Sinh, Địa)</option>
                        <option value="B03">B03 (Toán, Sinh, Văn)</option>
                        <option value="B04">B04 (Toán, Sinh, GDCD)</option>
                        <option value="B05">B05 (Toán, Sinh, KHXH)</option>
                        <option value="B08">B08 (Toán, Sinh, Anh)</option>
                    </select>
                </div>
                <div>
                    <label for="combo-c-select">Chọn khối C</label>
                    <select id="combo-c-select" class="combo-dropdown">
                        <option value="">-- Chọn tổ hợp C --</option>
                        <option value="C00">C00 (Văn, Sử, Địa)</option>
                        <option value="C19">C19 (Văn, Sử, GDCD)</option>
                        <option value="C20">C20 (Văn, Địa, GDCD)</option>
                        <option value="C14">C14 (Văn, Toán, GDCD)</option>
                        <option value="C15">C15 (Văn, Toán, KHXH)</option>
                        <option value="C16">C16 (Văn, Lý, GDCD)</option>
                        <option value="C17">C17 (Văn, Hóa, GDCD)</option>
                        <option value="C01">C01 (Văn, Toán, Lý)</option>
                        <option value="C02">C02 (Văn, Toán, Hóa)</option>
                        <option value="C03">C03 (Văn, Toán, Sử)</option>
                        <option value="C04">C04 (Văn, Toán, Địa)</option>
                        <option value="C05">C05 (Văn, Lý, Hóa)</option>
                        <option value="C06">C06 (Văn, Lý, Sinh)</option>
                        <option value="C07">C07 (Văn, Lý, Sử)</option>
                        <option value="C08">C08 (Văn, Hóa, Sinh)</option>
                        <option value="C09">C09 (Văn, Lý, Địa)</option>
                        <option value="C10">C10 (Văn, Hóa, Sử)</option>
                        <option value="C12">C12 (Văn, Sinh, Sử)</option>
                        <option value="C13">C13 (Văn, Sinh, Địa)</option>
                    </select>
                </div>
                <div>
                    <label for="combo-d">Chọn khối D</label>
                    <select id="combo-d" class="combo-dropdown">
                        <option value="">-- Chọn tổ hợp D --</option>
                        <option value="D01">D01 (Toán, Văn, Anh)</option>
                        <option value="D02">D02 (Toán, Văn, Nga)</option>
                        <option value="D03">D03 (Toán, Văn, Pháp)</option>
                        <option value="D04">D04 (Toán, Văn, Trung)</option>
                        <option value="D05">D05 (Toán, Văn, Đức)</option>
                        <option value="D06">D06 (Toán, Văn, Nhật)</option>
                        <option value="D07">D07 (Toán, Hóa, Anh)</option>
                        <option value="D08">D08 (Toán, Sinh, Anh)</option>
                        <option value="D09">D09 (Toán, Sử, Anh)</option>
                        <option value="D10">D10 (Toán, Địa, Anh)</option>
                        <option value="D11">D11 (Văn, Lý, Anh)</option>
                        <option value="D12">D12 (Văn, Hóa, Anh)</option>
                        <option value="D13">D13 (Văn, Sinh, Anh)</option>
                        <option value="D14">D14 (Văn, Sử, Anh)</option>
                        <option value="D15">D15 (Văn, Địa, Anh)</option>
                        <option value="D78">D78 (Văn, KHXH, Anh)</option>
                    </select>
                </div>
                <div>
                    <label for="combo-nk">Chọn khối năng khiếu</label>
                    <select id="combo-nk" class="combo-dropdown">
                        <option value="">-- Chọn năng khiếu --</option>
                        <optgroup label="Khối V (Kiến trúc)">
                            <option value="V00">V00 (Toán, Lý, Vẽ)</option>
                            <option value="V01">V01 (Toán, Văn, Vẽ)</option>
                            <option value="V02">V02 (Toán, Anh, Vẽ)</option>
                        </optgroup>
                        <optgroup label="Khối H (Mỹ thuật/Thiết kế)">
                            <option value="H00">H00 (Văn, NK1, NK2)</option>
                            <option value="H01">H01 (Toán, Văn, Vẽ)</option>
                            <option value="H02">H02 (Toán, Anh, Vẽ)</option>
                            <option value="H03">H03 (Văn, Anh, Vẽ)</option>
                            <option value="H04">H04 (Toán, NK1, NK2)</option>
                            <option value="H05">H05 (Văn, NK1, NK2)</option>
                            <option value="H06">H06 (Anh, NK1, NK2)</option>
                            <option value="H07">H07 (Toán, Anh, NK2)</option>
                            <option value="H08">H08 (Văn, Anh, NK2)</option>
                        </optgroup>
                        <optgroup label="Khối M (Mầm non)">
                            <option value="M00">M00 (Văn, Toán, NK Mầm non)</option>
                            <option value="M01">M01 (Văn, Sử, NK Mầm non)</option>
                            <option value="M02">M02 (Toán, Anh, NK Mầm non)</option>
                        </optgroup>
                        <optgroup label="Khối N (Âm nhạc)">
                            <option value="N00">N00 (Văn, NK1, NK2 Âm nhạc)</option>
                        </optgroup>
                        <optgroup label="Khối S (Sân khấu - Điện ảnh)">
                            <option value="S00">S00 (Văn, NK1, NK2 SKĐA)</option>
                            <option value="S01">S01 (Toán, Văn, NK SKĐA)</option>
                        </optgroup>
                        <optgroup label="Khối T (Thể thao)">
                            <option value="T00">T00 (Toán, Sinh, NK TDTT)</option>
                            <option value="T01">T01 (Toán, Văn, NK TDTT)</option>
                        </optgroup>
                        <optgroup label="Khối R (Quản lý VH/Báo chí)">
                            <option value="R00">R00 (Văn, Sử, NK Văn hóa/Báo chí)</option>
                        </optgroup>
                    </select>
                </div>
                <div id="admission-subjects"
                    style="grid-column: 1 / -1; display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px;">
                </div>
            </div>
            <div class="admission-actions">
                <button class="admission-btn" id="btn-calc">Tính điểm các tổ hợp</button>
                <button class="admission-btn" id="btn-clear">Xóa nhập liệu</button>
            </div>
            <div class="admission-result" id="admission-result"></div>
                <div class="admission-note">Nhập điểm theo thang 10. Gợi ý ngành phù hợp. Gợi ý trường dựa trên mức điểm.
                </div>
            </div>
        </section>

        <section class="memories-section section-wrapper" style="padding: 0; background: linear-gradient(135deg, rgba(127, 127, 213, 0.15) 0%, rgba(134, 168, 231, 0.15) 50%, rgba(145, 234, 228, 0.15) 100%), rgba(255, 255, 255, 0.85);">
            <div class="memory-card"
                style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap; margin: 0; border-radius: 0 0 22px 22px;">
                <div class="memory-title" style="margin:0;"><i class="fas fa-images"></i> Kỷ niệm lớp <span data-text="class.className">12C1</span></div>
                <a class="memory-btn" href="#" data-link="photos.album" target="_blank"
                    rel="noopener">Xem album</a>
            </div>
        </section>

        <section class="report-links section-wrapper">
            <h2><i class="fas fa-file-signature"></i> Cập nhật SYLL đầu năm</h2>
            <ul>
                <li><a href="#" data-link="syll.soyeulylichlop" class="link-1" target="_blank"><i
                            class="fas fa-file-alt"></i> Sơ yếu
                        lý lịch</a></li>
            </ul>
        </section>

        <section class="report-links section-wrapper">
            <h2><i class="fas fa-clipboard-list"></i> Ban Cán Sự Lớp Báo Cáo</h2>
            <ul>
                <li><a href="tonghopbaocao.html" class="link-1"><i class="fas fa-list-alt"></i> Tổng hợp báo cáo</a></li>
                <li><a href="#" data-link="reports.lt" class="link-8"><i class="fas fa-crown"></i>
                        Lớp
                        Trưởng</a></li>
                <li><a href="#" data-link="reports.lpht" class="link-7"><i class="fas fa-book-reader"></i> Lớp Phó Học Tập</a></li>
                <li><a href="#" data-link="reports.lpld" class="link-4"><i class="fas fa-broom"></i>
                        Lớp Phó Lao Động</a></li>
                <li><a href="#" data-link="reports.lppt" class="link-5"><i class="fas fa-music"></i> Lớp Phó Phong Trào</a></li>
                <li><a href="#" data-link="reports.lptt" class="link-6"><i class="fas fa-gavel"></i>
                        Lớp Phó Trật Tự</a></li>
                <li><a href="#" data-link="reports.tt" class="link-2"><i class="fas fa-user-tie"></i>
                        Tổ Trưởng</a></li>
                <li><a href="#" data-link="reports.thuquy" class="link-3"><i class="fas fa-piggy-bank"></i>
                        Thủ Quỹ</a></li>
            </ul>
        </section>

        <section class="report-links section-wrapper">
            <h2><i class="fas fa-user-shield"></i> Giáo viên chủ nhiệm</h2>
            <ul>
                <li><a href="tongketlop.html" class="link-10"><i
                            class="fas fa-chart-line"></i> Tổng kết Lớp</a></li>
                <li><a href="#" class="link-11 protected-link"
                        data-link="gvcn.dulieuLop"><i
                            class="fas fa-database"></i> Dữ liệu lớp</a></li>
                <li><a href="gvcn.html" class="link-16"><i class="fas fa-calendar-week"></i> Tổng kết Tuần</a></li>
                <li><a href="#" data-link="gvcn.lienhePhuHuynh" class="link-15"><i class="fas fa-users"></i> Liên hệ nhanh Phụ
                        huynh</a></li>
            </ul>
        </section>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" class="password-modal">
        <div class="password-content">
            <h3><i class="fas fa-lock"></i> Nhập mật khẩu</h3>
            <input type="password" id="passwordInput" placeholder="Nhập mật khẩu..." autofocus>
            <div class="password-error" id="passwordError">Mật khẩu không đúng!</div>
            <div>
                <button onclick="validateInput()">Xác nhận</button>
                <button class="btn-cancel" onclick="closePasswordModal()">Hủy</button>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="data.js"></script>
    <script>
        // Cập nhật title ngay khi data.js load xong (trước khi DOM ready)
        if (typeof CLASS_INFO !== 'undefined') {
            document.title = CLASS_INFO.fullName;
        }
        
        // ============================================
        // CẬP NHẬT TẤT CẢ CÁC LINK TỪ data.js
        // ============================================
        function updateAllLinks() {
            // Hàm helper để lấy giá trị từ object theo path string (vd: "career.chatgpt")
            function getValueByPath(obj, path) {
                return path.split('.').reduce((current, key) => current && current[key], obj);
            }
            
            // Cập nhật tất cả các link có data-link attribute
            document.querySelectorAll('[data-link]').forEach(link => {
                const linkPath = link.getAttribute('data-link');
                let url = '';
                
                // Xử lý các link đặc biệt
                if (linkPath === 'gvcn.phone') {
                    url = GVCN_INFO.phoneUrl;
                } else if (linkPath === 'gvcn.zalo') {
                    url = GVCN_INFO.zaloUrl;
                } else {
                    // Lấy URL từ LINKS object
                    url = getValueByPath(LINKS, linkPath);
                }
                
                if (url) {
                    // Nếu là protected link, cập nhật data-url thay vì href
                    if (link.classList.contains('protected-link')) {
                        link.setAttribute('data-url', url);
                    } else {
                        link.setAttribute('href', url);
                    }
                }
            });
        }
        
        // ============================================
        // CẬP NHẬT TẤT CẢ CÁC TEXT TỪ data.js
        // ============================================
        function updateAllTexts() {
            // Hàm helper để lấy giá trị từ object theo path string
            function getValueByPath(obj, path) {
                return path.split('.').reduce((current, key) => current && current[key], obj);
            }
            
            // Mapping các data-text attribute với đường dẫn trong data.js
            const textMappings = {
                'class.fullName': CLASS_INFO.fullName,
                'class.className': CLASS_INFO.className,
                'class.schoolYear': CLASS_INFO.schoolYear,
                'gvcn.name': GVCN_INFO.name,
                'gvcn.display': `GVCN: ${GVCN_INFO.displayName}`
            };
            
            // Cập nhật tất cả các element có data-text attribute
            document.querySelectorAll('[data-text]').forEach(element => {
                const textPath = element.getAttribute('data-text');
                const textValue = textMappings[textPath];
                if (textValue) {
                    element.textContent = textValue;
                }
            });
            
            // Cập nhật title
            const titleElement = document.querySelector('title[data-text]');
            if (titleElement) {
                titleElement.textContent = CLASS_INFO.fullName;
            }
            
            // Cập nhật các tooltip có data-tooltip-gvcn
            document.querySelectorAll('[data-tooltip-gvcn]').forEach(element => {
                element.setAttribute('data-tooltip', GVCN_INFO.name);
            });
        }
        
        // Chạy khi DOM đã load xong
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                updateAllLinks();
                updateAllTexts();
            });
        } else {
            updateAllLinks();
            updateAllTexts();
        }
        
        // Cấu hình hệ thống
        const maxAttempts = 5;
        const lockoutTime = 15 * 60 * 1000;
        const sessionDuration = 60 * 60 * 1000;

        let targetLink = '';
        let targetPage = '';
        let errorCount = 0;
        let blockTime = 0;

        // Kiểm tra phiên làm việc
        function checkSession() {
            const session = sessionStorage.getItem('userSession');
            if (session) {
                const sessionTime = parseInt(session);
                if (Date.now() - sessionTime < sessionDuration) {
                    return true;
                } else {
                    sessionStorage.removeItem('userSession');
                }
            }
            return false;
        }

        // Lưu phiên làm việc
        function saveSession() {
            sessionStorage.setItem('userSession', Date.now().toString());
        }

        // Kiểm tra trạng thái khóa
        function isLockedOut() {
            const lockout = localStorage.getItem('systemLockout');
            if (lockout) {
                blockTime = parseInt(lockout);
                if (Date.now() < blockTime) {
                    const remainingMinutes = Math.ceil((blockTime - Date.now()) / 60000);
                    return remainingMinutes;
                } else {
                    localStorage.removeItem('systemLockout');
                    localStorage.removeItem('errorCount');
                    errorCount = 0;
                }
            }
            return false;
        }

        // Xác thực đầu vào qua Google Apps Script
        async function validateInput() {
            const input = document.getElementById('passwordInput').value.trim();

            if (!input) {
                document.getElementById('passwordError').textContent = 'Vui lòng nhập mật khẩu!';
                document.getElementById('passwordError').style.display = 'block';
                return;
            }

            try {
                // Gọi Google Apps Script để xác thực
                const formData = new FormData();
                formData.append('action', 'verify');
                formData.append('password', input);
                if (targetPage) {
                    formData.append('page', targetPage);
                }
                
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    document.getElementById('passwordError').textContent = 'Lỗi kết nối. Vui lòng thử lại.';
                    document.getElementById('passwordError').style.display = 'block';
                    return;
                }
                
                const text = await response.text();
                let data;
                try {
                    data = JSON.parse(text);
                } catch (e) {
                    console.error('Invalid JSON response:', text);
                    document.getElementById('passwordError').textContent = 'Lỗi xử lý dữ liệu. Vui lòng thử lại.';
                    document.getElementById('passwordError').style.display = 'block';
                    return;
                }

                if (data.success) {
                    // Mật khẩu đúng
                    localStorage.removeItem('errorCount');
                    errorCount = 0;

                    window.open(targetLink, '_blank');
                    closePasswordModal();
                } else {
                    // Mật khẩu sai
                    errorCount = parseInt(localStorage.getItem('errorCount') || '0') + 1;
                    localStorage.setItem('errorCount', errorCount.toString());

                    if (errorCount >= maxAttempts) {
                        blockTime = Date.now() + lockoutTime;
                        localStorage.setItem('systemLockout', blockTime.toString());
                        document.getElementById('passwordError').textContent =
                            `Bạn đã nhập sai ${maxAttempts} lần. Tài khoản bị khóa trong 15 phút.`;
                        document.getElementById('passwordInput').disabled = true;
                    } else {
                        const remaining = maxAttempts - errorCount;
                        document.getElementById('passwordError').textContent =
                            `Mật khẩu không đúng! Còn ${remaining} lần thử.`;
                    }

                    document.getElementById('passwordError').style.display = 'block';
                    document.getElementById('passwordInput').value = '';
                    document.getElementById('passwordInput').focus();
                }
            } catch (error) {
                console.error('Lỗi xử lý:', error);
                document.getElementById('passwordError').textContent = 'Có lỗi xảy ra. Vui lòng thử lại!';
                document.getElementById('passwordError').style.display = 'block';
            }
        }

        // Đóng modal
        function closePasswordModal() {
            document.getElementById('passwordModal').classList.remove('active');
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordError').style.display = 'none';
            document.getElementById('passwordInput').disabled = false;
            targetLink = '';
            targetPage = '';
        }

        // Đóng modal khi click bên ngoài
        document.getElementById('passwordModal').addEventListener('click', function (e) {
            if (e.target === this) {
                closePasswordModal();
            }
        });

        // Enter để xác nhận
        document.getElementById('passwordInput').addEventListener('keypress', function (e) {
            if (e.key === 'Enter' && !this.disabled) {
                validateInput();
            }
        });

        // ========== BIRTHDAY FUNCTIONALITY ==========
        // Danh sách học sinh với ngày sinh (chỉ lưu trong code, không hiển thị)
        const students = [
            { name: 'Nguyễn Minh Anh', birthDay: 25, birthMonth: 1 },
            { name: 'Nguyễn Thị Xuân Nhi', birthDay: 7, birthMonth: 4 },
            { name: 'Trần Thị Cẩm Nhung', birthDay: 17, birthMonth: 7 },
            { name: 'Trần Thị Thúy Quỳnh', birthDay: 16, birthMonth: 4 },
            { name: 'Nguyễn Thị Tú Sương', birthDay: 4, birthMonth: 4 },
            { name: 'Lê Đông Thy', birthDay: 26, birthMonth: 12 },
            { name: 'Nguyễn Phạm Bảo Trân', birthDay: 29, birthMonth: 8 },
            { name: 'Nguyễn Thị Kim Cương', birthDay: 8, birthMonth: 11 },
            { name: 'Huỳnh Minh Tường', birthDay: 27, birthMonth: 10 },
            { name: 'Nguyễn Thị Thuỳ Dương', birthDay: 11, birthMonth: 11 },
            { name: 'Nguyễn Thành Đạt', birthDay: 5, birthMonth: 9 },
            { name: 'Trần Tiến Đạt', birthDay: 3, birthMonth: 2 },
            { name: 'Bùi Minh Đức', birthDay: 28, birthMonth: 11 },
            { name: 'Trần Gia Huệ', birthDay: 19, birthMonth: 2 },
            { name: 'Đinh Trung Kiên', birthDay: 18, birthMonth: 3 },
            { name: 'Lê Thị Thúy Kiều', birthDay: 16, birthMonth: 5 },
            { name: 'Lê Thị Thúy Kiều', birthDay: 15, birthMonth: 12 },
            { name: 'Trần Nguyễn Hồng Lam', birthDay: 3, birthMonth: 6 },
            { name: 'Nguyễn Thị Kiều Liên', birthDay: 22, birthMonth: 8 },
            { name: 'Lê Ngọc Linh', birthDay: 23, birthMonth: 11 },
            { name: 'Tăng Hoàng Trúc Linh', birthDay: 19, birthMonth: 9 },
            { name: 'Trần Thanh Long', birthDay: 23, birthMonth: 12 },
            { name: 'Nguyễn Kim Tường My', birthDay: 9, birthMonth: 11 },
            { name: 'Phạm Thị Kim Ngọc', birthDay: 18, birthMonth: 11 },
            { name: 'Nguyễn Thiện Nhân', birthDay: 30, birthMonth: 8 },
            { name: 'Trần Ngọc Nhân', birthDay: 27, birthMonth: 3 },
            { name: 'Trần Thị Yến Nhi', birthDay: 12, birthMonth: 11 },
            { name: 'Bùi Thị Thiện Như', birthDay: 16, birthMonth: 4 },
            { name: 'Bùi Trần Quỳnh Như', birthDay: 6, birthMonth: 11 },
            { name: 'Phạm Minh Nhựt', birthDay: 17, birthMonth: 11 },
            { name: 'Lê Minh Quí', birthDay: 13, birthMonth: 9 },
            { name: 'Bùi Thị Kiều Quy', birthDay: 4, birthMonth: 12 },
            { name: 'Nguyễn Thị Bích Thi', birthDay: 26, birthMonth: 9 },
            { name: 'Trương Thị Bảo Thi', birthDay: 5, birthMonth: 3 },
            { name: 'Nguyễn Đức Thịnh', birthDay: 30, birthMonth: 12 },
            { name: 'Dương Ngọc Thư', birthDay: 28, birthMonth: 10 },
            { name: 'Hồng Ngọc Anh Thư', birthDay: 23, birthMonth: 5 },
            { name: 'Lê Văn Thuận', birthDay: 30, birthMonth: 4 },
            { name: 'Lê Hoàng Bảo Thy', birthDay: 30, birthMonth: 11 },
            { name: 'Nguyễn Thị Bảo Trăm', birthDay: 23, birthMonth: 2 },
            { name: 'Nguyễn Thị Ngọc Trân', birthDay: 26, birthMonth: 1 },
            { name: 'Lê Thị Như Ý', birthDay: 10, birthMonth: 12 },
            { name: 'Lê Thị Ngọc Yến', birthDay: 24, birthMonth: 7 },
            { name: 'Nguyễn Thị Thảo Vi', birthDay: 20, birthMonth: 8 },
            { name: 'Nguyễn Trúc Đào', birthDay: 21, birthMonth: 6 },
            { name: 'Nguyễn Thị Ánh Hồng', birthDay: 9, birthMonth: 3 },
            { name: 'Hà Thị Tuyết My', birthDay: 23, birthMonth: 12 },
            { name: 'Nguyễn Thị Kim Tiên', birthDay: 9, birthMonth: 6 }
        ];
        // đưa danh sách ra global để các tiện ích khác (vd. vòng quay may mắn) sử dụng
        window.students = students;

        // Kiểm tra sinh nhật hôm nay
        function checkBirthday() {
            const today = new Date();
            const todayDay = today.getDate();
            const todayMonth = today.getMonth() + 1; // getMonth() trả về 0-11

            const birthdayStudents = students.filter(student =>
                student.birthDay === todayDay && student.birthMonth === todayMonth
            );

            if (birthdayStudents.length > 0) {
                // Có sinh nhật hôm nay
                const birthdaySection = document.getElementById('birthdaySection');
                const birthdayName = document.getElementById('birthdayName');

                if (birthdayStudents.length === 1) {
                    // Chỉ 1 học sinh
                    birthdayName.textContent = birthdayStudents[0].name;
                } else {
                    // Nhiều học sinh
                    birthdayName.textContent = birthdayStudents.map(s => s.name).join(', ');
                }

                birthdaySection.classList.remove('hidden');
                createConfetti();
            }
        }

        // Tạo hiệu ứng pháo hoa/confetti
        function createConfetti() {
            const colors = ['#ff6b6b', '#feca57', '#48dbfb', '#ff9ff3', '#54a0ff', '#5f27cd', '#00d2d3', '#ff6348'];
            const confettiCount = 100;

            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = (Math.random() * 10 + 5) + 'px';
                    confetti.style.height = (Math.random() * 10 + 5) + 'px';
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    confetti.style.animationDelay = Math.random() * 2 + 's';

                    document.body.appendChild(confetti);

                    setTimeout(() => {
                        confetti.remove();
                    }, 5000);
                }, i * 20);
            }
        }

        // Xử lý click vào link được bảo vệ
        document.querySelectorAll('.protected-link').forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();

                // Luôn yêu cầu nhập lại password mỗi lần click
                // Kiểm tra trạng thái khóa
                const lockoutMinutes = isLockedOut();
                if (lockoutMinutes) {
                    document.getElementById('passwordError').textContent =
                        `Bạn đã nhập sai quá nhiều lần. Vui lòng thử lại sau ${lockoutMinutes} phút.`;
                    document.getElementById('passwordError').style.display = 'block';
                    document.getElementById('passwordInput').disabled = true;
                } else {
                    document.getElementById('passwordInput').disabled = false;
                    document.getElementById('passwordError').style.display = 'none';
                }

                targetLink = this.getAttribute('data-url');
                // Xác định page dựa trên class của link
                if (this.classList.contains('link-11')) {
                    targetPage = 'dl'; // Dữ liệu lớp
                } else if (this.classList.contains('link-10')) {
                    targetPage = ''; // Tổng kết lớp - không có password riêng
                } else {
                    targetPage = '';
                }
                document.getElementById('passwordModal').classList.add('active');
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            });
        });

        // Chạy kiểm tra khi trang load
        checkBirthday();

        // ========== COUNTDOWN THI HK1, HK2, TỐT NGHIỆP ==========
        // Ngày thi mặc định (sẽ được cập nhật từ Google Sheets)
        let EXAM_TIME_HK1 = null;
        let EXAM_TIME_HK2 = null;
        let EXAM_TIME_TN = null;
        
        // Flag để track xem đã load được ngày thi từ sheet chưa
        let examDatesLoaded = {
            hk1: false,
            hk2: false,
            tn: false
        };

        // Function parse ngày từ format DD/MM/YYYY
        function parseDate(dateStr) {
            if (!dateStr) return null;
            const parts = dateStr.split('/');
            if (parts.length === 3) {
                const day = parseInt(parts[0]);
                const month = parseInt(parts[1]) - 1; // Month is 0-indexed
                const year = parseInt(parts[2]);
                return new Date(year, month, day, 0, 0, 0);
            }
            return null;
        }

        // Function cập nhật ngày thi và text hiển thị
        function updateExamDate(prefix, examDate, dateStr) {
            if (prefix === 'hk1') {
                EXAM_TIME_HK1 = examDate;
                examDatesLoaded.hk1 = true;
                const noteEl = document.querySelector('#countdown-hk1').parentElement.querySelector('.countdown-note');
                if (noteEl) {
                    noteEl.textContent = `Thi học kỳ 1: ${dateStr}`;
                }
            } else if (prefix === 'hk2') {
                EXAM_TIME_HK2 = examDate;
                examDatesLoaded.hk2 = true;
                const noteEl = document.querySelector('#countdown-hk2').parentElement.querySelector('.countdown-note');
                if (noteEl) {
                    noteEl.textContent = `Thi học kỳ 2: ${dateStr} (dự kiến)`;
                }
            } else if (prefix === 'tn') {
                EXAM_TIME_TN = examDate;
                examDatesLoaded.tn = true;
                const noteEl = document.querySelector('#countdown-tn').parentElement.querySelector('.countdown-note');
                if (noteEl) {
                    noteEl.textContent = `Thi tốt nghiệp THPT: ${dateStr} (dự kiến)`;
                }
            }
        }

        function renderCountdown(examTime, prefix, containerId) {
            const daysEl = document.getElementById(`cd-${prefix}-days`);
            const hoursEl = document.getElementById(`cd-${prefix}-hours`);
            const minsEl = document.getElementById(`cd-${prefix}-mins`);
            const secsEl = document.getElementById(`cd-${prefix}-secs`);
            const containerEl = document.getElementById(containerId);
            const noteEl = containerEl?.parentElement?.querySelector('.countdown-note');
            
            if (!daysEl || !containerEl) return;

            // Nếu không có ngày thi hoặc chưa load được từ sheet
            if (!examTime || !examDatesLoaded[prefix]) {
                daysEl.textContent = '00';
                hoursEl.textContent = '00';
                minsEl.textContent = '00';
                secsEl.textContent = '00';
                
                if (noteEl) {
                    noteEl.textContent = 'Hãy cập nhật ngày thi';
                }
                return;
            }

            const now = new Date();
            let diff = examTime - now;

            if (diff <= 0) {
                // Đã hoàn thành
                containerEl.innerHTML = '<div class="countdown-completed">✓ Đã hoàn thành</div>';
                return;
            }

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const mins = Math.floor((diff / (1000 * 60)) % 60);
            const secs = Math.floor((diff / 1000) % 60);

            daysEl.textContent = String(days).padStart(2, '0');
            hoursEl.textContent = String(hours).padStart(2, '0');
            minsEl.textContent = String(mins).padStart(2, '0');
            secsEl.textContent = String(secs).padStart(2, '0');
        }

        function updateAllCountdowns() {
            renderCountdown(EXAM_TIME_HK1, 'hk1', 'countdown-hk1');
            renderCountdown(EXAM_TIME_HK2, 'hk2', 'countdown-hk2');
            renderCountdown(EXAM_TIME_TN, 'tn', 'countdown-tn');
        }

        updateAllCountdowns();
        setInterval(updateAllCountdowns, 1000);

        // ========== ADMISSION CALCULATOR ==========
        (function () {
            const combos = {
                A00: ['toan', 'ly', 'hoa'],
                A01: ['toan', 'ly', 'anh'],
                A02: ['toan', 'ly', 'sinh'],
                A03: ['toan', 'ly', 'su'],
                A04: ['toan', 'ly', 'dia'],
                A05: ['toan', 'hoa', 'su'],
                A06: ['toan', 'hoa', 'dia'],
                A07: ['toan', 'su', 'dia'],
                A08: ['toan', 'su', 'gdcd'],
                A09: ['toan', 'dia', 'gdcd'],
                A10: ['toan', 'ly', 'gdcd'],
                A11: ['toan', 'hoa', 'gdcd'],
                A12: ['toan', 'khtn', 'khxh'],
                A14: ['toan', 'khtn', 'dia'],
                A15: ['toan', 'khtn', 'gdcd'],
                A16: ['toan', 'khtn', 'van'],
                A18: ['toan', 'hoa', 'khxh'],
                B00: ['toan', 'hoa', 'sinh'],
                B01: ['toan', 'sinh', 'su'],
                B02: ['toan', 'sinh', 'dia'],
                B03: ['toan', 'sinh', 'van'],
                B04: ['toan', 'sinh', 'gdcd'],
                B05: ['toan', 'sinh', 'khxh'],
                B08: ['toan', 'sinh', 'anh'],
                C00: ['van', 'su', 'dia'],
                C01: ['van', 'toan', 'ly'],
                C03: ['van', 'toan', 'su'],
                C04: ['van', 'toan', 'dia'],
                C19: ['van', 'su', 'gdcd'],
                C20: ['van', 'dia', 'gdcd'],
                C14: ['van', 'toan', 'gdcd'],
                C15: ['van', 'toan', 'khxh'],
                C16: ['van', 'ly', 'gdcd'],
                C17: ['van', 'hoa', 'gdcd'],
                C02: ['van', 'toan', 'hoa'],
                C05: ['van', 'ly', 'hoa'],
                C06: ['van', 'ly', 'sinh'],
                C07: ['van', 'ly', 'su'],
                C08: ['van', 'hoa', 'sinh'],
                C09: ['van', 'ly', 'dia'],
                C10: ['van', 'hoa', 'su'],
                C12: ['van', 'sinh', 'su'],
                C13: ['van', 'sinh', 'dia'],
                D01: ['toan', 'van', 'anh'],
                D02: ['toan', 'van', 'nga'],
                D03: ['toan', 'van', 'phap'],
                D04: ['toan', 'van', 'trung'],
                D05: ['toan', 'van', 'duc'],
                D06: ['toan', 'van', 'nhat'],
                D07: ['toan', 'hoa', 'anh'],
                D08: ['toan', 'sinh', 'anh'],
                D09: ['toan', 'su', 'anh'],
                D10: ['toan', 'dia', 'anh'],
                D11: ['van', 'ly', 'anh'],
                D12: ['van', 'hoa', 'anh'],
                D13: ['van', 'sinh', 'anh'],
                D14: ['van', 'su', 'anh'],
                D15: ['van', 'dia', 'anh'],
                D78: ['van', 'khxh', 'anh'],
                V00: ['toan', 'ly', 've'],
                V01: ['toan', 'van', 've'],
                V02: ['toan', 'anh', 've'],
                H00: ['van', 've1', 've2'],
                H01: ['toan', 'van', 've'],
                H02: ['toan', 'anh', 've'],
                H03: ['van', 'anh', 've'],
                H04: ['toan', 've1', 've2'],
                H05: ['van', 've1', 've2'],
                H06: ['anh', 've1', 've2'],
                H07: ['toan', 'anh', 've2'],
                H08: ['van', 'anh', 've2'],
                M00: ['van', 'toan', 'nk'],
                M01: ['van', 'su', 'nk'],
                M02: ['toan', 'anh', 'nk'],
                N00: ['van', 'nk1', 'nk2'],
                S00: ['van', 'nk1', 'nk2'],
                S01: ['toan', 'van', 'nk'],
                T00: ['toan', 'sinh', 'nk'],
                T01: ['toan', 'van', 'nk'],
                R00: ['van', 'su', 'nk']
            };

            const subjectsLabel = {
                toan: 'Toán',
                ly: 'Vật lý',
                hoa: 'Hóa',
                anh: 'Tiếng Anh',
                van: 'Ngữ văn',
                su: 'Lịch sử',
                dia: 'Địa lý',
                sinh: 'Sinh học',
                gdcd: 'GDCD',
                khxh: 'KHXH',
                khtn: 'KHTN',
                nga: 'Tiếng Nga',
                phap: 'Tiếng Pháp',
                trung: 'Tiếng Trung',
                duc: 'Tiếng Đức',
                nhat: 'Tiếng Nhật',
                ve: 'Vẽ mỹ thuật',
                ve1: 'Vẽ NK1',
                ve2: 'Vẽ NK2',
                nk: 'Năng khiếu',
                nk1: 'NK1',
                nk2: 'NK2'
            };

            const suggests = [
                { min: 0, max: 18, text: 'Phù hợp cao đẳng / ĐH địa phương; chương trình thường.' },
                { min: 18, max: 22, text: 'Trường ĐH vùng/địa phương ĐBSCL: TVU, KGU, TGU, ĐH Đồng Tháp, Tây Đô.' },
                { min: 22, max: 25, text: 'ĐH Cần Thơ (đa số ngành), ĐH An Giang (ĐHQG), NCTU, FPT Cần Thơ.' },
                { min: 25, max: 40, text: 'ĐH Cần Thơ các ngành hot (CNTT, Kinh tế, QTKD), NCTU/FPT CT chương trình chất lượng cao.' }
            ];

            const suggestMajors = {
                A00: 'CNTT, Cơ khí, Điện-Điện tử, Kỹ thuật, Kinh tế',
                A01: 'CNTT, KH máy tính, Kinh tế, Logistics',
                A02: 'Kỹ thuật môi trường, CNSH ứng dụng',
                A03: 'Kỹ thuật/CNTT/Kinh tế; phù hợp thí sinh mạnh Lý+Sử',
                A04: 'Kỹ thuật/CNTT/Kinh tế; thí sinh mạnh Lý+Địa',
                A05: 'Kỹ thuật/CNTT/Kinh tế; thí sinh mạnh Hóa+Sử',
                A06: 'Kỹ thuật/CNTT/Kinh tế; thí sinh mạnh Hóa+Địa',
                A07: 'Toán-Sử-Địa: chủ yếu Kinh tế, QTKD, Luật, Du lịch (một số trường)',
                A08: 'Toán-Sử-GDCD: một số ngành Kinh tế/QLNN/GDCD ở trường địa phương',
                A09: 'Toán-Địa-GDCD: một số ngành QL đất đai, Kinh tế tài nguyên, GDCD',
                A10: 'Toán-Lý-GDCD: ngành hiếm; vài ngành kỹ thuật/QLNN ở trường địa phương',
                A11: 'Toán-Hóa-GDCD: ngành hiếm; vài ngành CNTP/Môi trường/QLNN (trường địa phương)',
                A12: 'Toán-KHTN-KHXH: tổ hợp tích hợp; xét hạn chế ở một số trường mở rộng',
                A14: 'Toán-KHTN-Địa: một số ngành tài nguyên, môi trường, kinh tế địa phương',
                A15: 'Toán-KHTN-GDCD: rất hiếm; vài ngành GDCD/QLNN',
                A16: 'Toán-KHTN-Văn: tích hợp; một số ngành SP tích hợp/QL giáo dục',
                A18: 'Toán-Hóa-KHXH: hiếm; có thể vào CNTP/Môi trường/Kinh tế ứng dụng',
                B00: 'Y, Dược, Điều dưỡng, CNSH',
                B01: 'Toán-Sinh-Sử: hiếm; một số Y tế công cộng/CTXH/giáo dục',
                B02: 'Toán-Sinh-Địa: hiếm; một số tài nguyên, môi trường, nông lâm',
                B03: 'CNSH, Môi trường, SP Sinh',
                B04: 'Toán-Sinh-GDCD: hiếm; một số GDCD/QLNN ở trường địa phương',
                B05: 'Toán-Sinh-KHXH: hiếm; một số CTXH/giáo dục/môi trường',
                B08: 'Sinh, Môi trường, Y sinh',
                C00: 'Luật; Báo chí/PR/Truyền thông; Sư phạm Văn/Sử/Địa/tiểu học/mầm non; Du lịch-VH; Tâm lý/CTXH',
                C01: 'CNTT/Kỹ thuật (một số trường); Quản trị/Kế toán/Tài chính; SP kỹ thuật; GD tiểu học',
                C02: 'Kinh tế/Quản trị; một số kỹ thuật/ô tô ở trường top giữa; SP tích hợp',
                C03: 'Quản trị/Marketing/KDQT; Quản lý đất đai, tài nguyên, BĐS; một số ngành an ninh',
                C04: 'Du lịch/Quản trị; Quản lý đất đai, BĐS; kinh tế ứng dụng',
                C05: 'Môi trường, Nông nghiệp, Thực phẩm; SP KHTN; CTXH/Tâm lý',
                C06: 'Sinh học ứng dụng, Môi trường; SP KHTN; CTXH/Tâm lý',
                C07: 'Lý-Sử: ngành hiếm, chủ yếu SP tích hợp/KHXH; CTXH/Tâm lý',
                C08: 'Hóa-Sinh: Thực phẩm, Môi trường, Nông Lâm, Điều dưỡng/Y tế công cộng (một số trường)',
                C09: 'Lý-Địa: Quản lý đất đai, BĐS, tài nguyên; SP tích hợp',
                C10: 'Hóa-Sử: ngành hiếm; SP, CTXH/Tâm lý (một số trường)',
                C12: 'Sinh-Sử: CTXH/Tâm lý; SP tích hợp; Môi trường/Nông nghiệp (một số trường)',
                C13: 'Sinh-Địa: Nông Lâm, Môi trường, Tài nguyên; SP KHTN',
                C14: 'Văn-Toán-GDCD: Giáo dục chính trị, SP GDCD, Quản lý nhà nước, Luật',
                C15: 'Văn-Toán-KHXH: Giáo dục chính trị, Quản lý nhà nước, Luật',
                C16: 'Văn-Lý-GDCD: Quản lý giáo dục/chính trị; ngành hiếm',
                C17: 'Văn-Hóa-GDCD: Quản lý giáo dục/chính trị; ngành hiếm',
                C19: 'Văn-Sử-GDCD (hot): Luật, SP Văn/Sử/GDCD, Du lịch, Văn hóa, CTXH',
                C20: 'Văn-Địa-GDCD (hot): Luật, SP Văn/Địa/GDCD, Du lịch, Văn hóa, CTXH',
                D01: 'Kinh tế, Ngoại ngữ, CNTT',
                D02: 'Ngôn ngữ Nga',
                D03: 'Ngôn ngữ Pháp',
                D04: 'Ngôn ngữ Trung',
                D05: 'Ngôn ngữ Đức',
                D06: 'Ngôn ngữ Nhật',
                D07: 'CNTT, Kinh tế, Kỹ thuật',
                D08: 'Sinh, Môi trường, Y sinh',
                D09: 'Toán-Sử-Anh: Báo chí, Quan hệ công chúng, Du lịch, Luật',
                D10: 'Toán-Địa-Anh: Du lịch, Quản lý đất đai, BĐS, Kinh tế tài nguyên',
                D11: 'Văn-Lý-Anh: Báo chí/PR, CTXH, SP tích hợp',
                D12: 'Văn-Hóa-Anh: Văn hóa học, Du lịch, CTXH',
                D13: 'Văn-Sinh-Anh: CTXH, Tâm lý; một số ngành Sinh/Môi trường (hiếm)',
                D14: 'Văn-Sử-Anh: Báo chí, PR, Việt Nam học, Du lịch',
                D15: 'Văn-Địa-Anh: Du lịch, Địa lý du lịch, Quản lý đất đai, BĐS',
                D78: 'Văn-KHXH-Anh: PR/Truyền thông, Việt Nam học, Du lịch',
                V00: 'Kiến trúc/Quy hoạch; Thiết kế nội thất (thiên kỹ thuật); Đô thị học',
                V01: 'Kiến trúc/Quy hoạch; Thiết kế nội thất; ưu tiên Văn',
                V02: 'Kiến trúc/Quy hoạch; Thiết kế nội thất; lợi thế Anh',
                H00: 'Thiết kế đồ họa/Thời trang/Nội thất; Mỹ thuật CN; Hội họa/Điêu khắc; SP Mỹ thuật',
                H01: 'Thiết kế đồ họa/Nội thất (cần Toán); SP Mỹ thuật',
                H02: 'Thiết kế đồ họa/Nội thất (Toán+Anh+Vẽ)',
                H03: 'Thiết kế đồ họa/Nội thất (Văn+Anh+Vẽ)',
                H04: 'Mỹ thuật CN/Hội họa/Điêu khắc (thi 2 NK, Toán)',
                H05: 'Mỹ thuật CN/Hội họa/Điêu khắc (thi 2 NK, Văn)',
                H06: 'Mỹ thuật CN/Hội họa/Điêu khắc (thi 2 NK, Anh)',
                H07: 'Thiết kế đồ họa (Toán+Anh+NK2)',
                H08: 'Thiết kế đồ họa (Văn+Anh+NK2)',
                M00: 'Giáo dục Mầm non, Giáo dục đặc biệt',
                M01: 'Giáo dục Mầm non (thi Văn, Sử, NK)',
                M02: 'Giáo dục Mầm non (thi Toán, Anh, NK)',
                N00: 'Thanh nhạc, Nhạc cụ (Piano/Tây/Truyền thống), SP Âm nhạc, Chỉ huy',
                S00: 'Diễn viên/Đạo diễn/Quay phim/Biên kịch; Nhiếp ảnh nghệ thuật',
                S01: 'Diễn viên/Đạo diễn/Quay phim (Toán+Văn+NK)',
                T00: 'GD thể chất, Huấn luyện thể thao, Quản lý TDTT, Y sinh học TDTT',
                T01: 'GD thể chất/Huấn luyện (Toán, Văn, NK TDTT)',
                R00: 'Quản lý văn hóa/Thông tin cổ động; một số ngành Báo chí kiểm tra năng khiếu viết'
            };

            const subjectsContainer = document.getElementById('admission-subjects');
            const selects = Array.from(document.querySelectorAll('.combo-dropdown'));
            // ưu tiên chọn mục đầu tiên có value; nếu là placeholder rỗng thì fallback A00
            let currentCombo = selects.find(s => s.value)?.value || 'A00';

            function renderSubjects(comboKey) {
                const subs = combos[comboKey] || [];
                subjectsContainer.innerHTML = '';
                subs.forEach(s => {
                    const wrap = document.createElement('div');
                    wrap.innerHTML = `
                        <label>${subjectsLabel[s] || s}</label>
                        <input type="number" data-subject="${s}" placeholder="0 - 10" min="0" max="10" step="0.1">
                    `;
                    subjectsContainer.appendChild(wrap);
                });
            }

            function getScoreInput(sub) {
                const el = subjectsContainer.querySelector(`input[data-subject="${sub}"]`);
                if (!el) return null;
                const v = parseFloat(el.value);
                return isNaN(v) ? null : v;
            }

            function suggestText(score) {
                const hit = suggests.find(s => score >= s.min && score < s.max);
                return hit ? hit.text : '';
            }

            function suggestComboText(combo) {
                return suggestMajors[combo] || '';
            }

            function suggestSchoolsSouth(score, combo) {
                const upper = score;
                let base = '';
                const isA = combo.startsWith('A');
                const isB = ['B00', 'B01', 'B02', 'B03', 'B04', 'B05', 'B08'].includes(combo);

                if (isA) {
                    if (upper >= 26) {
                        base = 'Top A: BK HCM, KHTN HCM, UIT, FTU HCM (Kinh tế/CNTT), UEH CLC, UEL, CTU CLC ngành hot.';
                    } else if (upper >= 23) {
                        base = 'A tầm trung: CTU ngành CNTT/Kinh tế/Kỹ thuật; HCMUTE; NLU (Nông Lâm) công nghệ; UFM/UEH hệ chuẩn; NCTU/FPT CT.';
                    } else if (upper >= 20) {
                        base = 'A vừa sức: CTU đa số ngành; AGU; NCTU; NLU; ĐH Công nghiệp HCM; ĐH GTVT HCM.';
                    } else {
                        base = 'A <20: ĐH địa phương/ngoài công lập ĐBSCL: TVU, KGU, TGU, ĐH Đồng Tháp, Tây Đô; xét học bạ/cao đẳng.';
                    }
                } else if (isB) {
                    if (upper >= 26.5) {
                        base = 'Y siêu top: ĐH Y Dược TP.HCM; Khoa Y ĐHQG HCM; ĐH Y Dược Cần Thơ (ngành hot); Y khoa Phạm Ngọc Thạch (HK TP.HCM).';
                    } else if (upper >= 23) {
                        base = 'Y tầm trung: ĐH Y Dược Cần Thơ; HV YHCT; Điều dưỡng/Xét nghiệm chất lượng cao tại CTU, HCMUAF, HCMUTE; tham khảo Y Dược Thái Bình/Hải Phòng.';
                    } else if (upper >= 20) {
                        base = 'Y vừa sức: Điều dưỡng, Xét nghiệm, Hình ảnh tại ĐH vùng/ngoài công lập (TVU, KGU, TGU, Tây Đô); CTU các ngành Sinh/CNTP/CNSH; HCMUAF (CNTP/CNSH); ĐH Y tế công cộng.';
                    } else {
                        base = 'B <20: cân nhắc CĐ/ĐH địa phương; Điều dưỡng/Xét nghiệm hệ CLC ở trường tư; CNTP/Môi trường/Nông nghiệp tại NLU, TVU, KGU, TGU.';
                    }
                } else if (combo.startsWith('D')) {
                    if (upper >= 26) {
                        base = 'Top D: FTU HCM (Kinh tế/Ngôn ngữ); UEH CLC; HCMUS-IS (KHDL/IT); BK HCM (D07), KHTN HCM; CTU CLC ngành hot; HCMUSSH (ngôn ngữ/BC/PR).';
                    } else if (upper >= 23) {
                        base = 'D tầm trung: CTU ngành Kinh tế/Ngôn ngữ/CNTT; UEL; UFM; NCTU/FPT CT; HCMUSSH (nhiều ngành XH); HCMUTE (một số kỹ thuật D07).';
                    } else if (upper >= 20) {
                        base = 'D vừa sức: CTU đa số ngành; AGU; NCTU; HCMUAF (Ngôn ngữ/QLDL); ĐH Sài Gòn; ĐH Công nghiệp HCM; ĐH GTVT HCM; ngoài công lập ĐBSCL.';
                    } else {
                        base = 'D <20: ĐH địa phương/ngoài công lập ĐBSCL (TVU, KGU, TGU, Đồng Tháp, Tây Đô); xét học bạ và các ngành ngôn ngữ/du lịch/kế toán.';
                    }
                } else if (combo.startsWith('C')) {
                    if (upper >= 25) {
                        base = 'C top: ĐH Luật HCM; KHXH&NV HCM; Sư phạm HCM (Văn/Sử/Địa/GDCD); FTU HCM (một số ngành PR/Ngôn ngữ); CTU CLC ngành Luật/BC.';
                    } else if (upper >= 22) {
                        base = 'C tầm trung: CTU ngành Luật/BC/PR/Du lịch; HCMUSSH; ĐH Văn Lang/UEF/HAU (ngôn ngữ/du lịch/PR); ĐH Mở HCM.';
                    } else if (upper >= 20) {
                        base = 'C vừa sức: CTU đa số ngành XH; TVU/TGU ngành Luật/Du lịch/CTXH; ĐH Nội vụ; ĐH Văn hóa; ngoài công lập ĐBSCL.';
                    } else {
                        base = 'C <20: ĐH địa phương/ngoài công lập ĐBSCL (TVU, KGU, TGU, Đồng Tháp, Tây Đô); ngành Luật/Du lịch/CTXH/Việt Nam học.';
                    }
                } else {
                    if (upper < 20) {
                        base = 'ĐH địa phương/ngoài công lập: TVU, KGU, TGU, ĐH Đồng Tháp, Tây Đô.';
                    } else if (upper < 22) {
                        base = 'ĐH vùng ĐBSCL: CTU (một số ngành), AGU, NCTU, FPT Cần Thơ (xét học bạ); TVU, KGU.';
                    } else if (upper < 25) {
                        base = 'CTU đa số ngành; AGU; NCTU; FPT Cần Thơ; SPKT HCM (ngành trung); UEH hệ chuẩn; UFM.';
                    } else {
                        base = 'Top miền Nam: BK HCM, KHTN HCM, CTU ngành hot/CLC, SPKT HCM ngành hot, FTU HCM, UEH CLC, Y Dược (nếu khối B đủ điểm), FPT ĐH.';
                    }
                }

                if (['H', 'V', 'M', 'N', 'T', 'S', 'R'].includes(combo)) {
                    base = 'Trường năng khiếu miền Nam: ĐH Kiến trúc HCM (V/H), Mỹ thuật CN, SPKT HCM (V/H); Sư phạm HCM (M/N), Nhạc viện HCM (N), SKĐA HCM (S), TDTT (T).';
                } else if (combo.startsWith('C')) {
                    base += ' Khối C: ưu tiên Luật/Báo chí/Sư phạm/Du lịch tại CTU, TVU, TGU; đủ điểm có thể nhắm ĐH Luật HCM, KHXH&NV HCM.';
                }

                return base;
            }

            selects.forEach(sel => {
                sel.addEventListener('change', (e) => {
                    const val = e.target.value;
                    if (val && combos[val]) {
                        currentCombo = val;
                        renderSubjects(val);
                        document.getElementById('admission-result').innerHTML = '';
                    } else if (!val && (sel.id === 'combo-d' || sel.id === 'combo-ab')) {
                        // nếu chọn placeholder khối D hoặc A/B thì không đổi currentCombo
                    }
                });
            });

            document.getElementById('btn-calc')?.addEventListener('click', () => {
                const combo = currentCombo;
                const subs = combos[combo] || [];
                const scores = subs.map(s => getScoreInput(s));
                const resultEl = document.getElementById('admission-result');
                resultEl.innerHTML = '';

                if (scores.some(v => v === null)) {
                    resultEl.innerHTML = '<div class="admission-card"><p>Nhập đủ điểm 3 môn cho khối đã chọn.</p></div>';
                    return;
                }

                const subjectWeights = {
                    ve: 2, ve1: 2, ve2: 2,
                    nk: 2, nk1: 2, nk2: 2
                };

                // tính điểm có hệ số cho môn năng khiếu (nhân 2)
                const total = subs.reduce((sum, sub, idx) => {
                    const w = subjectWeights[sub] || 1;
                    const v = scores[idx] ?? 0;
                    return sum + v * w;
                }, 0);
                const card = document.createElement('div');
                card.className = 'admission-card';
                card.innerHTML = `<h4>Khối ${combo}</h4>
                    <p>Điểm (NK nhân hệ số 2): <strong>${total.toFixed(1)}</strong></p>
                    <p><strong>Ngành phù hợp:</strong> ${suggestComboText(combo)}</p>
                    <p><strong>Gợi ý trường (miền Nam):</strong> ${suggestSchoolsSouth(total, combo)}</p>`;
                resultEl.appendChild(card);
            });

            document.getElementById('btn-clear')?.addEventListener('click', () => {
                subjectsContainer.querySelectorAll('input').forEach(el => el.value = '');
                document.getElementById('admission-result').innerHTML = '';
            });

            // init
            renderSubjects(currentCombo);
        })();

        // ========== RANKING FROM GOOGLE SHEETS (CSV) ==========
        // Lấy từ config.js - tự động tính từ PUBLISHED_SPREADSHEET_URL và RANKING_SHEET_GID
        const RANKING_CSV_URL = typeof RANKING_SHEET_URL !== 'undefined' ? RANKING_SHEET_URL : 
            (typeof PUBLISHED_SPREADSHEET_URL !== 'undefined' && typeof RANKING_SHEET_GID !== 'undefined' ?
                `${PUBLISHED_SPREADSHEET_URL}/pub?gid=${RANKING_SHEET_GID}&single=true&output=csv` : '');
        
        // Sử dụng SCHOOL_WEEKS_CONFIG từ data.js (đã load trước đó)
        // Helper function để lấy week range string
        function getWeekRangeString(weekNumber) {
            if (typeof SCHOOL_WEEKS_CONFIG === 'undefined' || !SCHOOL_WEEKS_CONFIG) {
                return '';
            }
            if (weekNumber < 1 || weekNumber > SCHOOL_WEEKS_CONFIG.length) {
                return '';
            }
            const weekConfig = SCHOOL_WEEKS_CONFIG[weekNumber - 1];
            if (!weekConfig) return '';
            return `từ ngày ${weekConfig.from} đến ${weekConfig.to}`;
        }
        
        // Tạo WEEK_RANGES array từ SCHOOL_WEEKS_CONFIG
        const WEEK_RANGES = typeof SCHOOL_WEEKS_CONFIG !== 'undefined' && SCHOOL_WEEKS_CONFIG 
            ? SCHOOL_WEEKS_CONFIG.map(w => getWeekRangeString(w.week))
            : [];

        function parseVNDate(str) {
            const parts = str.split('/').map(Number);
            if (parts.length !== 3) return null;
            const [d, m, y] = parts;
            if (!d || !m || !y) return null;
            return new Date(y, m - 1, d);
        }

        function extractStartDate(rangeStr) {
            if (!rangeStr) return null;
            const match = rangeStr.match(/(\d{1,2}\/\d{1,2}\/\d{4})/);
            if (!match) return null;
            return parseVNDate(match[1]);
        }

        function getCurrentWeekNumber() {
            // Kiểm tra xem hàm từ data.js đã được load chưa (kiểm tra trong window scope)
            if (typeof window.getCurrentWeekNumber === 'function' && window.getCurrentWeekNumber !== getCurrentWeekNumber && typeof SCHOOL_WEEKS_CONFIG !== 'undefined') {
                return window.getCurrentWeekNumber();
            }
            
            // Fallback: tính toán từ SCHOOL_WEEKS_CONFIG
            if (typeof SCHOOL_WEEKS_CONFIG === 'undefined' || !SCHOOL_WEEKS_CONFIG || SCHOOL_WEEKS_CONFIG.length === 0) {
                return 1;
            }
            
            const today = new Date();
            // Normalize to midnight local time để tránh lỗi timezone
            const currentDate = new Date(today.getFullYear(), today.getMonth(), today.getDate());
            currentDate.setHours(0, 0, 0, 0);
            
            // Tìm tuần chứa ngày hiện tại
            for (let i = 0; i < SCHOOL_WEEKS_CONFIG.length; i++) {
                const weekConfig = SCHOOL_WEEKS_CONFIG[i];
                if (!weekConfig || !weekConfig.from || !weekConfig.to) continue;
                
                const [fromDay, fromMonth, fromYear] = weekConfig.from.split('/').map(Number);
                const [toDay, toMonth, toYear] = weekConfig.to.split('/').map(Number);
                
                // Kiểm tra dữ liệu hợp lệ
                if (isNaN(fromDay) || isNaN(fromMonth) || isNaN(fromYear) || 
                    isNaN(toDay) || isNaN(toMonth) || isNaN(toYear)) {
                    continue;
                }
                
                const startDate = new Date(fromYear, fromMonth - 1, fromDay);
                startDate.setHours(0, 0, 0, 0);
                const endDate = new Date(toYear, toMonth - 1, toDay);
                endDate.setHours(23, 59, 59, 999); // Bao gồm cả ngày cuối
                
                if (currentDate >= startDate && currentDate <= endDate) {
                    return weekConfig.week;
                }
            }
            
            // Nếu không tìm thấy tuần chứa ngày hiện tại, tìm tuần gần nhất trong quá khứ
            // (Vì Chủ nhật không được liệt kê trong tuần học, nên nếu hôm nay là Chủ nhật
            // hoặc nằm giữa các tuần, ta sẽ trả về tuần vừa qua)
            for (let i = SCHOOL_WEEKS_CONFIG.length - 1; i >= 0; i--) {
                const weekConfig = SCHOOL_WEEKS_CONFIG[i];
                if (!weekConfig || !weekConfig.from) continue;
                
                const [fromDay, fromMonth, fromYear] = weekConfig.from.split('/').map(Number);
                if (isNaN(fromDay) || isNaN(fromMonth) || isNaN(fromYear)) continue;
                
                const startDate = new Date(fromYear, fromMonth - 1, fromDay);
                startDate.setHours(0, 0, 0, 0);
                
                // Nếu tuần này bắt đầu trước hoặc bằng ngày hiện tại, đây là tuần gần nhất trong quá khứ
                if (startDate <= currentDate) {
                    return weekConfig.week;
                }
            }
            
            return 1;
        }

        function parseCsv(text) {
            const rows = [];
            let current = '';
            let inQuotes = false;
            let row = [];

            for (let i = 0; i < text.length; i++) {
                const c = text[i];
                const next = text[i + 1];
                if (c === '"' && inQuotes && next === '"') {
                    current += '"';
                    i++;
                } else if (c === '"') {
                    inQuotes = !inQuotes;
                } else if (c === ',' && !inQuotes) {
                    row.push(current);
                    current = '';
                } else if ((c === '\n' || c === '\r') && !inQuotes) {
                    if (current !== '' || row.length) {
                        row.push(current);
                        rows.push(row);
                        row = [];
                        current = '';
                    }
                } else {
                    current += c;
                }
            }
            if (current !== '' || row.length) {
                row.push(current);
                rows.push(row);
            }
            return rows;
        }

        async function loadRanking() {
            const statusEl = document.getElementById('rankingStatus');
            const tableEl = document.getElementById('rankingTable');
            try {
                if (!RANKING_CSV_URL) {
                    throw new Error('URL bảng thi đua chưa được cấu hình');
                }
                
                statusEl.textContent = 'Đang tải bảng...';
                const resp = await fetch(RANKING_CSV_URL, { cache: 'no-store' });
                if (!resp.ok) throw new Error('HTTP ' + resp.status);
                const text = await resp.text();
                const data = parseCsv(text).filter(r => r.length > 0);
                if (!data.length) throw new Error('Không có dữ liệu');

                const headers = data[0];
                let rows = data.slice(1).filter(r => r.some(cell => cell && cell.trim() !== ''));

                // Map rows với số tuần từ cột A
                const rowsWithWeek = rows.map(r => {
                    const wk = parseInt(r[0], 10);
                    return { row: r, weekNum: isNaN(wk) ? null : wk };
                }).filter(x => x.weekNum !== null && x.weekNum > 0);

                if (rowsWithWeek.length === 0) {
                    throw new Error('Không tìm thấy dữ liệu tuần hợp lệ');
                }

                // Kiểm tra ngày hiện tại để xác định tuần thời gian thực
                let currentWeek = null;
                
                // Thử sử dụng hàm getCurrentWeekNumber() từ data.js
                try {
                    if (typeof getCurrentWeekNumber === 'function' && typeof SCHOOL_WEEKS_CONFIG !== 'undefined' && SCHOOL_WEEKS_CONFIG) {
                        currentWeek = getCurrentWeekNumber();
                    }
                } catch (e) {
                    console.warn('Không thể sử dụng getCurrentWeekNumber:', e);
                }
                
                // Nếu không có, tính toán từ SCHOOL_WEEKS_CONFIG
                if (!currentWeek && typeof SCHOOL_WEEKS_CONFIG !== 'undefined' && SCHOOL_WEEKS_CONFIG && Array.isArray(SCHOOL_WEEKS_CONFIG)) {
                    try {
                        const today = new Date();
                        // Normalize to midnight local time để tránh lỗi timezone
                        const currentDate = new Date(today.getFullYear(), today.getMonth(), today.getDate());
                        currentDate.setHours(0, 0, 0, 0);
                        
                        // Tìm tuần chứa ngày hiện tại
                        for (let i = 0; i < SCHOOL_WEEKS_CONFIG.length; i++) {
                            const weekConfig = SCHOOL_WEEKS_CONFIG[i];
                            if (!weekConfig || !weekConfig.from || !weekConfig.to) continue;
                            
                            const [fromDay, fromMonth, fromYear] = weekConfig.from.split('/').map(Number);
                            const [toDay, toMonth, toYear] = weekConfig.to.split('/').map(Number);
                            
                            if (isNaN(fromDay) || isNaN(fromMonth) || isNaN(fromYear) || 
                                isNaN(toDay) || isNaN(toMonth) || isNaN(toYear)) continue;
                            
                            const startDate = new Date(fromYear, fromMonth - 1, fromDay);
                            startDate.setHours(0, 0, 0, 0);
                            const endDate = new Date(toYear, toMonth - 1, toDay);
                            endDate.setHours(23, 59, 59, 999); // Bao gồm cả ngày cuối
                            
                            if (currentDate >= startDate && currentDate <= endDate) {
                                currentWeek = weekConfig.week;
                                break;
                            }
                        }
                        
                        // Nếu không tìm thấy tuần chứa ngày hiện tại, tìm tuần gần nhất trong quá khứ
                        // (Vì Chủ nhật không được liệt kê trong tuần học, nên nếu hôm nay là Chủ nhật
                        // hoặc nằm giữa các tuần, ta sẽ trả về tuần vừa qua)
                        if (!currentWeek) {
                            for (let i = SCHOOL_WEEKS_CONFIG.length - 1; i >= 0; i--) {
                                const weekConfig = SCHOOL_WEEKS_CONFIG[i];
                                if (!weekConfig || !weekConfig.from) continue;
                                
                                const [fromDay, fromMonth, fromYear] = weekConfig.from.split('/').map(Number);
                                if (isNaN(fromDay) || isNaN(fromMonth) || isNaN(fromYear)) continue;
                                
                                const startDate = new Date(fromYear, fromMonth - 1, fromDay);
                                startDate.setHours(0, 0, 0, 0);
                                
                                // Nếu tuần này bắt đầu trước hoặc bằng ngày hiện tại, đây là tuần gần nhất trong quá khứ
                                if (startDate <= currentDate) {
                                    currentWeek = weekConfig.week;
                                    break;
                                }
                            }
                        }
                    } catch (e) {
                        console.warn('Lỗi khi tính tuần từ SCHOOL_WEEKS_CONFIG:', e);
                    }
                }
                
                // Nếu vẫn không có, lấy tuần lớn nhất từ dữ liệu
                if (!currentWeek || currentWeek <= 0) {
                    currentWeek = Math.max(...rowsWithWeek.map(x => x.weekNum));
                }
                
                // Đảm bảo currentWeek là số hợp lệ
                if (!currentWeek || currentWeek <= 0) {
                    currentWeek = rowsWithWeek[rowsWithWeek.length - 1].weekNum;
                }
                
                // Lấy 5 tuần gần nhất với tuần hiện tại (từ tuần hiện tại trở về trước)
                rowsWithWeek.sort((a, b) => (b.weekNum || 0) - (a.weekNum || 0));
                const filtered = rowsWithWeek.filter(x => x.weekNum <= currentWeek);
                rows = filtered.slice(0, 5).map(x => x.row);

                // Nếu không đủ 5 tuần, lấy tất cả các tuần có (tối đa 5)
                if (rows.length === 0) {
                    rows = rowsWithWeek.slice(0, Math.min(5, rowsWithWeek.length)).map(x => x.row);
                }

                // Render header - đảm bảo có đủ 6 cột
                const thead = document.createElement('thead');
                const headRow = document.createElement('tr');
                const headerLabels = ['Tuần', 'Tổ 1', 'Tổ 2', 'Tổ 3', 'Tổ 4', 'Hạng'];
                
                for (let idx = 0; idx < 6; idx++) {
                    const th = document.createElement('th');
                    if (headers[idx]) {
                        th.textContent = headers[idx].trim() || headerLabels[idx];
                    } else {
                        th.textContent = headerLabels[idx];
                    }
                    // Đảm bảo header cột F (index 5) là "Hạng"
                    if (idx === 5) {
                        th.textContent = 'Hạng';
                    }
                    headRow.appendChild(th);
                }
                thead.appendChild(headRow);

                // Render body
                const tbody = document.createElement('tbody');
                rows.forEach(r => {
                    const tr = document.createElement('tr');
                    // Đảm bảo có đủ 6 cột
                    for (let idx = 0; idx < 6; idx++) {
                        const td = document.createElement('td');
                        td.textContent = (r[idx] || '').toString().trim() || '';
                        td.style.textAlign = 'center';
                        
                        // Áp dụng class cho từng cột
                        if (idx === 0) td.classList.add('col-week'); // Cột A: Tuần
                        if (idx === 1) td.classList.add('col-t1');   // Cột B: Tổ 1
                        if (idx === 2) td.classList.add('col-t2');   // Cột C: Tổ 2
                        if (idx === 3) td.classList.add('col-t3');   // Cột D: Tổ 3
                        if (idx === 4) td.classList.add('col-t4');   // Cột E: Tổ 4
                        if (idx === 5) td.classList.add('col-rank'); // Cột F: Hạng
                        
                        tr.appendChild(td);
                    }
                    
                    // Tìm tổ hạng nhất: so sánh điểm số từ các cột B, C, D, E
                    const scores = [
                        { col: 1, score: parseFloat(r[1]) || 0, name: 'Tổ 1' },
                        { col: 2, score: parseFloat(r[2]) || 0, name: 'Tổ 2' },
                        { col: 3, score: parseFloat(r[3]) || 0, name: 'Tổ 3' },
                        { col: 4, score: parseFloat(r[4]) || 0, name: 'Tổ 4' }
                    ];
                    
                    // Sắp xếp theo điểm giảm dần
                    scores.sort((a, b) => b.score - a.score);
                    const maxScore = scores[0].score;
                    const winnerCols = [];
                    
                    // Tìm tất cả các tổ có điểm cao nhất (hạng nhất)
                    scores.forEach(s => {
                        if (s.score === maxScore && maxScore > 0) {
                            winnerCols.push(s.col);
                        }
                    });
                    
                    // Nếu không tìm được từ điểm số, thử đọc từ cột Hạng (F)
                    if (winnerCols.length === 0 && r[5]) {
                        const rankCell = (r[5] || '').toString().toLowerCase().trim();
                        const winnerMap = {
                            'tổ 1': 1, 'tổ1': 1,
                            'tổ 2': 2, 'tổ2': 2,
                            'tổ 3': 3, 'tổ3': 3,
                            'tổ 4': 4, 'tổ4': 4
                        };
                        
                        Object.keys(winnerMap).forEach(key => {
                            if (rankCell.includes(key)) {
                                winnerCols.push(winnerMap[key]);
                            }
                        });
                    }
                    
                    // Áp dụng hiệu ứng vinh danh cho tổ hạng nhất
                    winnerCols.forEach(colIdx => {
                        const td = tr.children[colIdx];
                        if (td) {
                            td.classList.add('winner-cell');
                            if (!td.textContent.includes('🏆')) {
                                td.textContent = '🏆 ' + td.textContent;
                            }
                        }
                    });

                    tbody.appendChild(tr);
                });

                // Clear và gắn
                tableEl.innerHTML = '';
                tableEl.appendChild(thead);
                tableEl.appendChild(tbody);
                statusEl.textContent = '';
            } catch (err) {
                console.error('Ranking load error', err);
                statusEl.textContent = 'Không tải được bảng: ' + (err.message || 'Lỗi không xác định');
                tableEl.innerHTML = '';
            }
        }

        // ========== TIMETABLE FROM GOOGLE SHEETS (CSV) ==========
        // Lấy từ config.js - tự động tính từ PUBLISHED_SPREADSHEET_URL và TIMETABLE_SHEET_GID
        const TIMETABLE_CSV_URL = TIMETABLE_SHEET_URL;

        // Map tên môn học với class CSS
        const subjectClassMap = {
            'Toán': 'subject-toan',
            'SHCN': 'subject-shcn',
            'Văn': 'subject-van',
            'Anh': 'subject-anh',
            'Sử': 'subject-su',
            'Địa': 'subject-dia',
            'GDKT&P': 'subject-gdktpl',
            'GDKT&PL': 'subject-gdktpl',
            'Tin': 'subject-tin',
            'CN(CN)': 'subject-cn',
            'HĐTN': 'subject-hdtn',
            'GDHN': 'subject-gdhn',
            'GDTC': 'subject-gdtc',
            'GDQP': 'subject-gdqp'
        };

        // Map tên ngày với index cột
        const dayIndexMap = {
            'HAI': 1,
            'BA': 2,
            'TƯ': 3,
            'NĂM': 4,
            'SÁU': 5,
            'BẢY': 6
        };

        async function loadTimetable() {
            const statusEl = document.getElementById('timetableStatus');
            const containerEl = document.getElementById('timetableContainer');
            
            try {
                statusEl.style.display = 'block';
                statusEl.textContent = 'Đang tải thời khóa biểu...';
                
                const resp = await fetch(TIMETABLE_CSV_URL, { cache: 'no-store' });
                if (!resp.ok) throw new Error('HTTP ' + resp.status);
                const text = await resp.text();
                const data = parseCsv(text).filter(r => r.length > 0);
                if (!data.length) throw new Error('Không có dữ liệu');

                // Đọc ngày thi từ các ô H2, I2, J2 (hàng 1, cột 7, 8, 9 trong CSV - index 1, 7, 8, 9)
                let examDateHK1 = null;
                let examDateHK2 = null;
                let examDateTN = null;
                
                if (data.length > 1) {
                    const row2 = data[1]; // Hàng 2 trong sheet (index 1 trong CSV)
                    if (row2.length > 9) {
                        // H2: Ngày thi HK1 (index 7)
                        const hk1DateStr = row2[7]?.toString().trim();
                        // I2: Ngày thi HK2 (index 8)
                        const hk2DateStr = row2[8]?.toString().trim();
                        // J2: Ngày thi TN THPT (index 9)
                        const tnDateStr = row2[9]?.toString().trim();
                        
                        // Parse ngày từ format DD/MM/YYYY
                        if (hk1DateStr) {
                            examDateHK1 = parseDate(hk1DateStr);
                        }
                        if (hk2DateStr) {
                            examDateHK2 = parseDate(hk2DateStr);
                        }
                        if (tnDateStr) {
                            examDateTN = parseDate(tnDateStr);
                        }
                        
                        // Cập nhật countdown nếu có dữ liệu
                        if (examDateHK1) {
                            updateExamDate('hk1', examDateHK1, hk1DateStr);
                        }
                        if (examDateHK2) {
                            updateExamDate('hk2', examDateHK2, hk2DateStr);
                        }
                        if (examDateTN) {
                            updateExamDate('tn', examDateTN, tnDateStr);
                        }
                        
                        // Refresh countdown ngay lập tức
                        updateAllCountdowns();
                    }
                }

                // Parse bảng giáo viên (tìm từ cột K, L, M - index 10, 11, 12)
                const teacherMap = {};
                let teacherTableStart = -1;
                
                // Tìm hàng header "STT", "Môn học", "Giáo viên" ở cột K, L, M
                for (let i = 0; i < data.length; i++) {
                    const row = data[i];
                    if (row.length > 12) {
                        const colK = row[10]?.toString().trim().toUpperCase();
                        const colL = row[11]?.toString().trim();
                        const colM = row[12]?.toString().trim();
                        
                        if (colK === 'STT' && colL && colL.includes('Môn') && colM && colM.includes('Giáo viên')) {
                            teacherTableStart = i;
                            break;
                        }
                    }
                }

                if (teacherTableStart >= 0) {
                    // Parse bảng giáo viên từ hàng teacherTableStart + 1
                    for (let i = teacherTableStart + 1; i < data.length; i++) {
                        const row = data[i];
                        if (row.length > 12) {
                            const subject = row[11]?.toString().trim(); // Cột L - Môn học
                            const teacher = row[12]?.toString().trim(); // Cột M - Giáo viên
                            if (subject && teacher && subject !== 'Môn học' && !subject.match(/^\d+$/)) {
                                teacherMap[subject] = teacher;
                                // Thêm mapping cho các biến thể tên môn
                                if (subject.includes('GDKT')) {
                                    teacherMap['GDKT&P'] = teacher;
                                    teacherMap['GDKT&PL'] = teacher;
                                }
                            }
                        }
                    }
                }

                // Parse thời khóa biểu buổi sáng và chiều
                // Tìm hàng bắt đầu với "TIẾT" ở cột đầu tiên
                let morningStart = -1;
                let afternoonStart = -1;
                
                for (let i = 0; i < data.length; i++) {
                    const row = data[i];
                    if (row.length > 0) {
                        const firstCell = row[0]?.toString().trim().toUpperCase();
                        // Kiểm tra xem có phải header "TIẾT" không
                        if (firstCell === 'TIẾT' || firstCell === 'TIET') {
                            // Kiểm tra xem có các cột ngày không (HAI, BA, TƯ, etc.)
                            const hasDays = row.some(cell => {
                                const cellUpper = cell?.toString().trim().toUpperCase();
                                return cellUpper === 'HAI' || cellUpper === 'BA' || cellUpper === 'TƯ' || 
                                       cellUpper === 'NĂM' || cellUpper === 'SÁU' || cellUpper === 'BẢY';
                            });
                            
                            if (hasDays) {
                                if (morningStart === -1) {
                                    morningStart = i;
                                } else if (afternoonStart === -1) {
                                    afternoonStart = i;
                                }
                            }
                        }
                    }
                }

                // Parse buổi sáng
                const morningSchedule = {};
                if (morningStart >= 0) {
                    const endRow = afternoonStart > 0 ? afternoonStart : data.length;
                    for (let i = morningStart + 1; i < endRow; i++) {
                        const row = data[i];
                        if (row.length >= 7) {
                            const period = row[0]?.toString().trim();
                            // Kiểm tra xem có phải số tiết không (1-5)
                            if (period && /^[1-5]$/.test(period)) {
                                const periodNum = parseInt(period);
                                morningSchedule[periodNum] = {
                                    hai: (row[1]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    ba: (row[2]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    tu: (row[3]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    nam: (row[4]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    sau: (row[5]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    bay: (row[6]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-')
                                };
                            }
                        }
                    }
                }

                // Parse buổi chiều
                const afternoonSchedule = {};
                if (afternoonStart >= 0) {
                    for (let i = afternoonStart + 1; i < data.length; i++) {
                        const row = data[i];
                        if (row.length >= 7) {
                            const period = row[0]?.toString().trim();
                            // Kiểm tra xem có phải số tiết không (2-5)
                            if (period && /^[2-5]$/.test(period)) {
                                const periodNum = parseInt(period);
                                afternoonSchedule[periodNum] = {
                                    hai: (row[1]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    ba: (row[2]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    tu: (row[3]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    nam: (row[4]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    sau: (row[5]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-'),
                                    bay: (row[6]?.toString().trim() || '-').replace(/^[\s\-]+$/, '-')
                                };
                            }
                        }
                    }
                }

                // Render thời khóa biểu
                renderTimetable(morningSchedule, afternoonSchedule, teacherMap);
                
                statusEl.style.display = 'none';
            } catch (err) {
                console.error('Timetable load error', err);
                statusEl.textContent = 'Không tải được thời khóa biểu. Đang sử dụng dữ liệu mặc định.';
                statusEl.style.display = 'block';
                // Fallback: render từ data.js
                renderTimetableFromData();
                
                // Nếu không load được ngày thi từ sheet, hiển thị 0 và thông báo
                if (!examDatesLoaded.hk1) {
                    const noteEl = document.querySelector('#countdown-hk1')?.parentElement?.querySelector('.countdown-note');
                    if (noteEl) {
                        noteEl.textContent = 'Hãy cập nhật ngày thi';
                    }
                }
                if (!examDatesLoaded.hk2) {
                    const noteEl = document.querySelector('#countdown-hk2')?.parentElement?.querySelector('.countdown-note');
                    if (noteEl) {
                        noteEl.textContent = 'Hãy cập nhật ngày thi';
                    }
                }
                if (!examDatesLoaded.tn) {
                    const noteEl = document.querySelector('#countdown-tn')?.parentElement?.querySelector('.countdown-note');
                    if (noteEl) {
                        noteEl.textContent = 'Hãy cập nhật ngày thi';
                    }
                }
                // Refresh countdown để hiển thị 0
                updateAllCountdowns();
            }
        }

        function renderTimetable(morningSchedule, afternoonSchedule, teacherMap) {
            const containerEl = document.getElementById('timetableContainer');
            
            // Tìm ngày áp dụng từ sheet hoặc dùng mặc định
            let applyDate = '12-01-2026';
            
            let html = `<span class="session-title">Buổi Sáng (Áp dụng: ${applyDate})</span>`;
            html += '<table><thead><tr><th>Tiết</th><th>Hai</th><th>Ba</th><th>Tư</th><th>Năm</th><th>Sáu</th><th>Bảy</th></tr></thead><tbody>';
            
            // Render buổi sáng
            for (let period = 1; period <= 5; period++) {
                if (morningSchedule[period]) {
                    html += '<tr><td>' + period + '</td>';
                    const days = ['hai', 'ba', 'tu', 'nam', 'sau', 'bay'];
                    days.forEach(day => {
                        const subject = morningSchedule[period][day] || '-';
                        html += renderSubjectCell(subject, teacherMap);
                    });
                    html += '</tr>';
                }
            }
            
            html += '</tbody></table>';
            html += '<span class="session-title">Trái Buổi: Chiều</span>';
            html += '<table><thead><tr><th>Tiết</th><th>Hai</th><th>Ba</th><th>Tư</th><th>Năm</th><th>Sáu</th><th>Bảy</th></tr></thead><tbody>';
            
            // Render buổi chiều
            for (let period = 2; period <= 5; period++) {
                if (afternoonSchedule[period]) {
                    html += '<tr><td>' + period + '</td>';
                    const days = ['hai', 'ba', 'tu', 'nam', 'sau', 'bay'];
                    days.forEach(day => {
                        const subject = afternoonSchedule[period][day] || '-';
                        html += renderSubjectCell(subject, teacherMap);
                    });
                    html += '</tr>';
                }
            }
            
            html += '</tbody></table>';
            containerEl.innerHTML = html;
        }

        function renderSubjectCell(subject, teacherMap) {
            if (!subject || subject === '-' || subject.trim() === '') {
                return '<td>-</td>';
            }
            
            const subjectClean = subject.trim();
            
            // Tìm giáo viên từ teacherMap với nhiều cách match
            let teacher = null;
            
            // Thử match trực tiếp
            if (teacherMap[subjectClean]) {
                teacher = teacherMap[subjectClean];
            } else {
                // Thử các biến thể tên môn
                const variants = [
                    subjectClean,
                    subjectClean.replace(/&amp;/g, '&'),
                    subjectClean.replace(/&/g, '&'),
                    subjectClean.replace('GDKT&P', 'GDKT'),
                    subjectClean.replace('GDKT&PL', 'GDKT'),
                    subjectClean.replace('GDKT&PL', 'GDKT&P'),
                    subjectClean.replace('CN(CN)', 'CN'),
                    subjectClean.replace(/\(CN\)/g, '(CN)')
                ];
                
                // Thử match không phân biệt hoa thường
                for (const variant of variants) {
                    for (const key in teacherMap) {
                        if (key.toLowerCase() === variant.toLowerCase() || 
                            key.replace(/&/g, '&').toLowerCase() === variant.toLowerCase()) {
                            teacher = teacherMap[key];
                            break;
                        }
                    }
                    if (teacher) break;
                }
                
                // Nếu vẫn không tìm thấy, thử partial match
                if (!teacher) {
                    for (const key in teacherMap) {
                        if (subjectClean.includes(key) || key.includes(subjectClean)) {
                            teacher = teacherMap[key];
                            break;
                        }
                    }
                }
            }
            
            // Nếu vẫn không tìm thấy, dùng "Không xác định"
            if (!teacher) {
                teacher = 'Không xác định';
            }
            
            const subjectClass = subjectClassMap[subjectClean] || '';
            const isGVCN = teacher === 'Võ Thanh Phong' || teacher === GVCN_INFO.name;
            const gvcnAttr = isGVCN ? ' data-tooltip-gvcn' : '';
            
            return `<td class="${subjectClass}" data-tooltip="${teacher}"${gvcnAttr}>${subjectClean}</td>`;
        }

        function renderTimetableFromData() {
            // Fallback: render từ TIMETABLE trong data.js
            const containerEl = document.getElementById('timetableContainer');
            const timetable = TIMETABLE;
            
            let html = `<span class="session-title">${timetable.morningTitle}</span>`;
            html += '<table><thead><tr><th>Tiết</th><th>Hai</th><th>Ba</th><th>Tư</th><th>Năm</th><th>Sáu</th><th>Bảy</th></tr></thead><tbody>';
            
            // Group by period
            const morningByPeriod = {};
            timetable.morning.forEach(item => {
                if (!morningByPeriod[item.period]) {
                    morningByPeriod[item.period] = {};
                }
                morningByPeriod[item.period][item.day] = item;
            });
            
            for (let period = 1; period <= 5; period++) {
                if (morningByPeriod[period]) {
                    html += '<tr><td>' + period + '</td>';
                    const days = ['hai', 'ba', 'tư', 'năm', 'sáu', 'bảy'];
                    days.forEach(day => {
                        const item = morningByPeriod[period][day];
                        if (item) {
                            const subjectClass = item.class || '';
                            const isGVCN = item.teacher === GVCN_INFO.name;
                            const gvcnAttr = isGVCN ? ' data-tooltip-gvcn' : '';
                            html += `<td class="${subjectClass}" data-tooltip="${item.teacher}"${gvcnAttr}>${item.subject === '-' ? '-' : item.subject}</td>`;
                        } else {
                            html += '<td>-</td>';
                        }
                    });
                    html += '</tr>';
                }
            }
            
            html += '</tbody></table>';
            html += `<span class="session-title">${timetable.afternoonTitle}</span>`;
            html += '<table><thead><tr><th>Tiết</th><th>Hai</th><th>Ba</th><th>Tư</th><th>Năm</th><th>Sáu</th><th>Bảy</th></tr></thead><tbody>';
            
            const afternoonByPeriod = {};
            timetable.afternoon.forEach(item => {
                if (!afternoonByPeriod[item.period]) {
                    afternoonByPeriod[item.period] = {};
                }
                afternoonByPeriod[item.period][item.day] = item;
            });
            
            for (let period = 2; period <= 5; period++) {
                if (afternoonByPeriod[period]) {
                    html += '<tr><td>' + period + '</td>';
                    const days = ['hai', 'ba', 'tư', 'năm', 'sáu', 'bảy'];
                    days.forEach(day => {
                        const item = afternoonByPeriod[period][day];
                        if (item) {
                            const subjectClass = item.class || '';
                            const isGVCN = item.teacher === GVCN_INFO.name;
                            const gvcnAttr = isGVCN ? ' data-tooltip-gvcn' : '';
                            html += `<td class="${subjectClass}" data-tooltip="${item.teacher}"${gvcnAttr}>${item.subject === '-' ? '-' : item.subject}</td>`;
                        } else {
                            html += '<td>-</td>';
                        }
                    });
                    html += '</tr>';
                }
            }
            
            html += '</tbody></table>';
            containerEl.innerHTML = html;
        }

        // Set link cho nút edit thời khóa biểu
        document.addEventListener('DOMContentLoaded', function() {
            const editLink = document.getElementById('timetableEditLink');
            if (editLink && typeof SHEET_LINKS !== 'undefined' && SHEET_LINKS.timetable) {
                editLink.href = SHEET_LINKS.timetable;
            }
        });

        // Tải bảng khi trang load
        loadRanking();
        loadTimetable();
    </script>

    <section class="contact-section">
        <a href="#" data-link="gvcn.phone" class="btn-contact btn-call"><i class="fas fa-phone-volume"></i> Gọi Điện</a>
        <a href="#" data-link="gvcn.zalo" class="btn-contact btn-zalo" target="_blank"><i
                class="fas fa-comment-dots"></i> Liên hệ Zalo</a>
    </section>
</body>

</html>
